Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 7008C3DE742
	for <lists+alsa-devel@lfdr.de>; Tue,  3 Aug 2021 09:35:41 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id E0444170E;
	Tue,  3 Aug 2021 09:34:50 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz E0444170E
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1627976141;
	bh=ibpX4zPYipdXCW9DQYQKHt6h0N7Zbh0kgpLMnA+5TpE=;
	h=Date:From:To:Subject:In-Reply-To:References:Cc:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=Xx8teRMuqeAezdv9Du77/TkMHZJPpvTmT51wjPylUKRhCGYvuEyA/acLMQsKEUupn
	 uuUHrcrao+8rAgg3nY8DeUqjmi5ldd0tbZC+EbGPB/SiP/fStpWAsS19Y///K0aamm
	 n57dWbJmFZ6x5pLEeTdiHmVC4xSxFmSzaj9WvcGA=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 1F92BF8032C;
	Tue,  3 Aug 2021 09:34:13 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id C1AF4F802E8; Tue,  3 Aug 2021 09:34:10 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.9 required=5.0 tests=DKIM_SIGNED,DKIM_VALID,
 DKIM_VALID_AU,PRX_BODY_30,SPF_HELO_NONE,SPF_NONE autolearn=disabled
 version=3.4.0
Received: from smtp-out2.suse.de (smtp-out2.suse.de [195.135.220.29])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id 7B86AF80095
 for <alsa-devel@alsa-project.org>; Tue,  3 Aug 2021 09:34:07 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 7B86AF80095
Authentication-Results: alsa1.perex.cz;
 dkim=pass (1024-bit key) header.d=suse.de header.i=@suse.de
 header.b="cViNMVRu"; 
 dkim=permerror (0-bit key) header.d=suse.de header.i=@suse.de
 header.b="8yGylLFG"
Received: from relay2.suse.de (relay2.suse.de [149.44.160.134])
 by smtp-out2.suse.de (Postfix) with ESMTP id 0E1F92009F;
 Tue,  3 Aug 2021 07:34:06 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
 t=1627976046; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
 mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=rXdJtGLDQ+wBCmobp3Y0JiVh7UhX3DxLaqDqHYPgrck=;
 b=cViNMVRuHdVxqGe12qDQLe2n2XIbj/qmE0buY8vEzEdQtd3QmNAPX/hxwG7+dqxMoNsuN/
 r2dYW3LosKneoLrZZTfCsaV3tjusZfghjf3CjI/vcmzN2w49dPc6Daq88jje94NPDpQLba
 myqu6Fx/B5w6T34k3UFU9LaTBzL3lIc=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
 s=susede2_ed25519; t=1627976046;
 h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
 mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=rXdJtGLDQ+wBCmobp3Y0JiVh7UhX3DxLaqDqHYPgrck=;
 b=8yGylLFGiyPpN7VTmEcpR1TjM6PLed1WYxfJYQswLr2cd2UGYER7u9IYIOMbeG1mJgE7hn
 GM8KKFZ4laW4YmBA==
Received: from alsa1.suse.de (alsa1.suse.de [10.160.4.42])
 by relay2.suse.de (Postfix) with ESMTP id 038F6A3BCA;
 Tue,  3 Aug 2021 07:34:06 +0000 (UTC)
Date: Tue, 03 Aug 2021 09:34:05 +0200
Message-ID: <s5hv94nvv6a.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Giuliano Zannetti - ART S.p.A. <giuliano.zannetti@artgroup-spa.com>
Subject: Re: I: dmix optimization
In-Reply-To: <DB9P192MB132136A569299BDE4E11AB90C5F09@DB9P192MB1321.EURP192.PROD.OUTLOOK.COM>
References: <DB9P192MB132193EF1C0E9DFA5161A298C5EF9@DB9P192MB1321.EURP192.PROD.OUTLOOK.COM>
 <DB9P192MB132136A569299BDE4E11AB90C5F09@DB9P192MB1321.EURP192.PROD.OUTLOOK.COM>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Cc: "alsa-devel@alsa-project.org" <alsa-devel@alsa-project.org>,
 "tiwai@suse.com" <tiwai@suse.com>
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Tue, 03 Aug 2021 09:26:38 +0200,
Giuliano Zannetti - ART S.p.A. wrote:
> 
(snip) 
> Could it be possible check for the first sample of the period only, as
> reported in the code below?

No, unfortunately your suggested optimization won't work reliably, I'm
afraid.

Each application may write samples partially, not always in period
size.  Also, the hardware may clear the buffer right after the hwptr
is updated, and again, it's not always in period size.  So, just
checking the first sample doesn't guarantee the rest period size is
also zero or non-zero.


thanks,

Takashi
