Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id F0CEE7080D
	for <lists+alsa-devel@lfdr.de>; Mon, 22 Jul 2019 20:00:43 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 693FF1830;
	Mon, 22 Jul 2019 19:59:53 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 693FF1830
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1563818443;
	bh=n5Q75aoxwVtNW4MEGQc6/HiU2TCoC+JVAW2xVPvYFMo=;
	h=Date:In-Reply-To:References:From:To:Cc:Subject:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=Q+syK9eiO1DW5cYx05NYNnKckDfc+1j0sMH7uyjcerrzpqoXNqxegCsPc4IwVz7oK
	 jh9z+8EfcbSjGDODmR7Ngy7Ohumti6lg1J4CPDFsq6MWXvtmUOdT+8kLdIUitlOWsB
	 Id1sCxP4+Py63JertxHXzmB8k9Jq/Mf8yKj6rEGs=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 5549DF8015B;
	Mon, 22 Jul 2019 19:57:34 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id CF904F803D7; Mon, 22 Jul 2019 19:57:28 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.9 required=5.0 tests=DKIM_SIGNED,DKIM_VALID,
 DKIM_VALID_AU,PRX_BODY_30,SPF_HELO_PASS,SPF_PASS,URIBL_BLOCKED
 autolearn=disabled version=3.4.0
Received: from rere.qmqm.pl (rere.qmqm.pl [91.227.64.183])
 (using TLSv1.2 with cipher ADH-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id CD0ADF800F5
 for <alsa-devel@alsa-project.org>; Mon, 22 Jul 2019 19:57:22 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz CD0ADF800F5
Authentication-Results: alsa1.perex.cz;
 dkim=pass (2048-bit key) header.d=rere.qmqm.pl header.i=@rere.qmqm.pl
 header.b="hbkwlLWL"
Received: from remote.user (localhost [127.0.0.1])
 by rere.qmqm.pl (Postfix) with ESMTPSA id 45sq6B3FmYzGX;
 Mon, 22 Jul 2019 19:56:02 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=rere.qmqm.pl; s=1;
 t=1563818162; bh=7SaQLhTkVkJkyrzdFIFilK3Cf0iKKeEDWWrf9UnLJz4=;
 h=Date:In-Reply-To:References:From:Subject:To:Cc:From;
 b=hbkwlLWLP+GQqqg57Ag/1ibJwo7Rc8CflDITevPit9mldNjshPJtWBHWfZJg77TCZ
 mWoYFm862V1xGq0Coiu0kc/6skgh9vlfYI17QfuRaFyCgPuc+1iMI4QmnT2Iz6Egsz
 BeQNHV/l5V6hUxEI+EBd8ECGj70/C9SXp5em/JIZmmuOxxbEa6j92gvhLyec2dR0Rh
 /ShCkh0yiSHRfDgEui8qxfln7uyoZSyPqyJaG0lJ9KPGIJcyYiY8QNw1fnx0u3sMsv
 kMcijEI4s/sIn7VQt35CCjLYIzYjz/YIy8Y8hUqyrr2pQKSeUCrB0KzbaEOLlQ0eUq
 4LkLkpkOD+zEA==
X-Virus-Status: Clean
X-Virus-Scanned: clamav-milter 0.100.3 at mail
Date: Mon, 22 Jul 2019 19:57:21 +0200
Message-Id: <3e104cf18cb4e26096f0fe065a2c0e80373f861c.1563817201.git.mirq-linux@rere.qmqm.pl>
In-Reply-To: <cover.1563817201.git.mirq-linux@rere.qmqm.pl>
References: <cover.1563817201.git.mirq-linux@rere.qmqm.pl>
From: =?UTF-8?q?Micha=C5=82=20Miros=C5=82aw?= <mirq-linux@rere.qmqm.pl>
MIME-Version: 1.0
To: alsa-devel@alsa-project.org
Cc: Alexandre Belloni <alexandre.belloni@bootlin.com>,
 Liam Girdwood <lgirdwood@gmail.com>, patches@opensource.cirrus.com,
 Nicolas Ferre <nicolas.ferre@microchip.com>, Takashi Iwai <tiwai@suse.com>,
 Ludovic Desroches <ludovic.desroches@microchip.com>,
 Mark Brown <broonie@kernel.org>,
 Codrin Ciubotariu <codrin.ciubotariu@microchip.com>
Subject: [alsa-devel] [PATCH 1/2] ASoC: wm8904: rework FLL handling
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

RXh0cmFjdCBhbmQgcmV3b3JrIEZMTCBoYW5kbGluZy4gVGhpcyBtYWtlcyBpdCBwb3NzaWJsZSB0
byByZXVzZQp0aGUgY29kZSBmb3Igb3RoZXIgV29sZnNvbiBjb2RlY3MgYW5kIG1ha2VzIGNvZGVj
IGFkYXB0IFNZU0NMSyB0bwpleGFjdGx5IG1hdGNoIGZyZXF1ZW5jeSByZXF1aXJlZCBmb3IgdXNl
ZCBzYW1wbGluZyByYXRlLgoKU2lnbmVkLW9mZi1ieTogTWljaGHFgiBNaXJvc8WCYXcgPG1pcnEt
bGludXhAcmVyZS5xbXFtLnBsPgotLS0KIC4uLi9kZXZpY2V0cmVlL2JpbmRpbmdzL3NvdW5kL3dt
ODkwNC50eHQgICAgICB8ICAgNCArCiBzb3VuZC9zb2MvYXRtZWwvYXRtZWxfd204OTA0LmMgICAg
ICAgICAgICAgICAgfCAgMTEgKy0KIHNvdW5kL3NvYy9jb2RlY3MvS2NvbmZpZyAgICAgICAgICAg
ICAgICAgICAgICB8ICAgNCArCiBzb3VuZC9zb2MvY29kZWNzL01ha2VmaWxlICAgICAgICAgICAg
ICAgICAgICAgfCAgIDIgKwogc291bmQvc29jL2NvZGVjcy93bTg5MDQuYyAgICAgICAgICAgICAg
ICAgICAgIHwgNDU0ICsrKysrLS0tLS0tLS0tLS0tLQogc291bmQvc29jL2NvZGVjcy93bTg5MDQu
aCAgICAgICAgICAgICAgICAgICAgIHwgICA1IC0KIHNvdW5kL3NvYy9jb2RlY3Mvd21fZmxsLmMg
ICAgICAgICAgICAgICAgICAgICB8IDMzOSArKysrKysrKysrKysrCiBzb3VuZC9zb2MvY29kZWNz
L3dtX2ZsbC5oICAgICAgICAgICAgICAgICAgICAgfCAgMjYgKwogOCBmaWxlcyBjaGFuZ2VkLCA0
OTIgaW5zZXJ0aW9ucygrKSwgMzUzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50
YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9zb3VuZC93bTg5MDQudHh0IGIvRG9jdW1lbnRhdGlv
bi9kZXZpY2V0cmVlL2JpbmRpbmdzL3NvdW5kL3dtODkwNC50eHQKaW5kZXggNjZiZjI2MTQyM2I5
Li42YjUxZDg3ZjU5ODcgMTAwNjQ0Ci0tLSBhL0RvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5k
aW5ncy9zb3VuZC93bTg5MDQudHh0CisrKyBiL0RvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5k
aW5ncy9zb3VuZC93bTg5MDQudHh0CkBAIC05LDYgKzksMTAgQEAgUmVxdWlyZWQgcHJvcGVydGll
czoKICAgLSBjbG9ja3M6IHJlZmVyZW5jZSB0bwogICAgIDxEb2N1bWVudGF0aW9uL2RldmljZXRy
ZWUvYmluZGluZ3MvY2xvY2svY2xvY2stYmluZGluZ3MudHh0PgogCitPcHRpb25hbCBwcm9wZXJ0
aWVzOgorICAtIHdsZixmbGwtaW5wdXQ6IEZMTCBpbnB1dCBzaWduYWw6ICJtY2xrIiwgImJjbGsi
LCAibHJjbGsiIG9yICJvc2MiCisJKCJtY2xrIiBieSBkZWZhdWx0KQorCiBQaW5zIG9uIHRoZSBk
ZXZpY2UgKGZvciBsaW5raW5nIGludG8gYXVkaW8gcm91dGVzKToKIAogICAqIElOMUwKZGlmZiAt
LWdpdCBhL3NvdW5kL3NvYy9hdG1lbC9hdG1lbF93bTg5MDQuYyBiL3NvdW5kL3NvYy9hdG1lbC9h
dG1lbF93bTg5MDQuYwppbmRleCA3NzZiMjdkMzY4NmUuLmI3N2VhMjQ5NWVmZSAxMDA2NDQKLS0t
IGEvc291bmQvc29jL2F0bWVsL2F0bWVsX3dtODkwNC5jCisrKyBiL3NvdW5kL3NvYy9hdG1lbC9h
dG1lbF93bTg5MDQuYwpAQCAtMzAsMjAgKzMwLDExIEBAIHN0YXRpYyBpbnQgYXRtZWxfYXNvY193
bTg5MDRfaHdfcGFyYW1zKHN0cnVjdCBzbmRfcGNtX3N1YnN0cmVhbSAqc3Vic3RyZWFtLAogCXN0
cnVjdCBzbmRfc29jX2RhaSAqY29kZWNfZGFpID0gcnRkLT5jb2RlY19kYWk7CiAJaW50IHJldDsK
IAotCXJldCA9IHNuZF9zb2NfZGFpX3NldF9wbGwoY29kZWNfZGFpLCBXTTg5MDRfRkxMX01DTEss
IFdNODkwNF9GTExfTUNMSywKLQkJMzI3NjgsIHBhcmFtc19yYXRlKHBhcmFtcykgKiAyNTYpOwot
CWlmIChyZXQgPCAwKSB7Ci0JCXByX2VycigiJXMgLSBmYWlsZWQgdG8gc2V0IHdtODkwNCBjb2Rl
YyBQTEwuIiwgX19mdW5jX18pOwotCQlyZXR1cm4gcmV0OwotCX0KLQogCS8qCiAJICogQXMgaGVy
ZSB3bTg5MDQgdXNlIEZMTCBvdXRwdXQgYXMgaXRzIHN5c3RlbSBjbG9jawotCSAqIHNvIGNhbGxp
bmcgc2V0X3N5c2NsayB3b24ndCBjYXJlIGZyZXEgcGFyYW1ldGVyCi0JICogdGhlbiB3ZSBwYXNz
IDAKIAkgKi8KIAlyZXQgPSBzbmRfc29jX2RhaV9zZXRfc3lzY2xrKGNvZGVjX2RhaSwgV004OTA0
X0NMS19GTEwsCi0JCQkwLCBTTkRfU09DX0NMT0NLX0lOKTsKKwkJCXBhcmFtc19yYXRlKHBhcmFt
cykgKiAyNTYsIFNORF9TT0NfQ0xPQ0tfSU4pOwogCWlmIChyZXQgPCAwKSB7CiAJCXByX2Vycigi
JXMgLWZhaWxlZCB0byBzZXQgd204OTA0IFNZU0NMS1xuIiwgX19mdW5jX18pOwogCQlyZXR1cm4g
cmV0OwpkaWZmIC0tZ2l0IGEvc291bmQvc29jL2NvZGVjcy9LY29uZmlnIGIvc291bmQvc29jL2Nv
ZGVjcy9LY29uZmlnCmluZGV4IDlmODlhNTM0NjI5OS4uMTVhMzlmYWYzM2FiIDEwMDY0NAotLS0g
YS9zb3VuZC9zb2MvY29kZWNzL0tjb25maWcKKysrIGIvc291bmQvc29jL2NvZGVjcy9LY29uZmln
CkBAIC0yODEsNiArMjgxLDkgQEAgY29uZmlnIFNORF9TT0NfQVJJWk9OQQogCWRlZmF1bHQgbSBp
ZiBTTkRfU09DX1dNODk5Nz1tCiAJZGVmYXVsdCBtIGlmIFNORF9TT0NfV004OTk4PW0KIAorY29u
ZmlnIFNORF9TT0NfV01fRkxMCisJdHJpc3RhdGUKKwogY29uZmlnIFNORF9TT0NfV01fSFVCUwog
CXRyaXN0YXRlCiAJZGVmYXVsdCB5IGlmIFNORF9TT0NfV004OTkzPXkgfHwgU05EX1NPQ19XTTg5
OTQ9eQpAQCAtMTMyNSw2ICsxMzI4LDcgQEAgY29uZmlnIFNORF9TT0NfV004OTAzCiBjb25maWcg
U05EX1NPQ19XTTg5MDQKIAl0cmlzdGF0ZSAiV29sZnNvbiBNaWNyb2VsZWN0cm9uaWNzIFdNODkw
NCBDT0RFQyIKIAlkZXBlbmRzIG9uIEkyQworCXNlbGVjdCBTTkRfU09DX1dNX0ZMTAogCiBjb25m
aWcgU05EX1NPQ19XTTg5NDAKICAgICAgICAgdHJpc3RhdGUKZGlmZiAtLWdpdCBhL3NvdW5kL3Nv
Yy9jb2RlY3MvTWFrZWZpbGUgYi9zb3VuZC9zb2MvY29kZWNzL01ha2VmaWxlCmluZGV4IDViNGJi
OGNmNDMyNS4uMjI3MDRmYmI3NDk3IDEwMDY0NAotLS0gYS9zb3VuZC9zb2MvY29kZWNzL01ha2Vm
aWxlCisrKyBiL3NvdW5kL3NvYy9jb2RlY3MvTWFrZWZpbGUKQEAgLTI2OSw2ICsyNjksNyBAQCBz
bmQtc29jLXdtOTA5MC1vYmpzIDo9IHdtOTA5MC5vCiBzbmQtc29jLXdtOTcwNS1vYmpzIDo9IHdt
OTcwNS5vCiBzbmQtc29jLXdtOTcxMi1vYmpzIDo9IHdtOTcxMi5vCiBzbmQtc29jLXdtOTcxMy1v
YmpzIDo9IHdtOTcxMy5vCitzbmQtc29jLXdtLWZsbC1vYmpzIDo9IHdtX2ZsbC5vCiBzbmQtc29j
LXdtLWh1YnMtb2JqcyA6PSB3bV9odWJzLm8KIHNuZC1zb2MtengtYXVkOTZwMjItb2JqcyA6PSB6
eF9hdWQ5NnAyMi5vCiAjIEFtcApAQCAtNTQ5LDYgKzU1MCw3IEBAIG9iai0kKENPTkZJR19TTkRf
U09DX1dNOTcwNSkJKz0gc25kLXNvYy13bTk3MDUubwogb2JqLSQoQ09ORklHX1NORF9TT0NfV005
NzEyKQkrPSBzbmQtc29jLXdtOTcxMi5vCiBvYmotJChDT05GSUdfU05EX1NPQ19XTTk3MTMpCSs9
IHNuZC1zb2Mtd205NzEzLm8KIG9iai0kKENPTkZJR19TTkRfU09DX1dNX0FEU1ApCSs9IHNuZC1z
b2Mtd20tYWRzcC5vCitvYmotJChDT05GSUdfU05EX1NPQ19XTV9GTEwpCSs9IHNuZC1zb2Mtd20t
ZmxsLm8KIG9iai0kKENPTkZJR19TTkRfU09DX1dNX0hVQlMpCSs9IHNuZC1zb2Mtd20taHVicy5v
CiBvYmotJChDT05GSUdfU05EX1NPQ19aWF9BVUQ5NlAyMikgKz0gc25kLXNvYy16eC1hdWQ5NnAy
Mi5vCiAKZGlmZiAtLWdpdCBhL3NvdW5kL3NvYy9jb2RlY3Mvd204OTA0LmMgYi9zb3VuZC9zb2Mv
Y29kZWNzL3dtODkwNC5jCmluZGV4IDVlYmRkMWQ5YWZkZS4uMDMzYTM4ZTQwOGI1IDEwMDY0NAot
LS0gYS9zb3VuZC9zb2MvY29kZWNzL3dtODkwNC5jCisrKyBiL3NvdW5kL3NvYy9jb2RlY3Mvd204
OTA0LmMKQEAgLTI0LDYgKzI0LDcgQEAKICNpbmNsdWRlIDxzb3VuZC90bHYuaD4KICNpbmNsdWRl
IDxzb3VuZC93bTg5MDQuaD4KIAorI2luY2x1ZGUgIndtX2ZsbC5oIgogI2luY2x1ZGUgIndtODkw
NC5oIgogCiBlbnVtIHdtODkwNF90eXBlIHsKQEAgLTY2LDEyICs2Nyw4IEBAIHN0cnVjdCB3bTg5
MDRfcHJpdiB7CiAJaW50IHJldHVuZV9tb2JpbGVfY2ZnOwogCXN0cnVjdCBzb2NfZW51bSByZXR1
bmVfbW9iaWxlX2VudW07CiAKLQkvKiBGTEwgc2V0dXAgKi8KLQlpbnQgZmxsX3NyYzsKLQlpbnQg
ZmxsX2ZyZWY7Ci0JaW50IGZsbF9mb3V0OwotCiAJLyogQ2xvY2tpbmcgY29uZmlndXJhdGlvbiAq
LworCXN0cnVjdCB3bV9mbGxfZGF0YSBmbGw7CiAJdW5zaWduZWQgaW50IG1jbGtfcmF0ZTsKIAlp
bnQgc3lzY2xrX3NyYzsKIAl1bnNpZ25lZCBpbnQgc3lzY2xrX3JhdGU7CkBAIC0zMTEsMzUgKzMw
OCwxMDkgQEAgc3RhdGljIGJvb2wgd204OTA0X3JlYWRhYmxlX3JlZ2lzdGVyKHN0cnVjdCBkZXZp
Y2UgKmRldiwgdW5zaWduZWQgaW50IHJlZykKIAl9CiB9CiAKLXN0YXRpYyBpbnQgd204OTA0X2Nv
bmZpZ3VyZV9jbG9ja2luZyhzdHJ1Y3Qgc25kX3NvY19jb21wb25lbnQgKmNvbXBvbmVudCkKK3N0
YXRpYyB2b2lkIHdtODkwNF91bnByZXBhcmVfc3lzY2xrKHN0cnVjdCB3bTg5MDRfcHJpdiAqcHJp
dikKIHsKKwlzd2l0Y2ggKHByaXYtPnN5c2Nsa19zcmMpIHsKKwljYXNlIFdNODkwNF9DTEtfTUNM
SzoKKwkJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKHByaXYtPm1jbGspOworCQlicmVhazsKKworCWNh
c2UgV004OTA0X0NMS19GTEw6CisJCXdtX2ZsbF9kaXNhYmxlKCZwcml2LT5mbGwpOworCQlicmVh
azsKKwl9Cit9CisKK3N0YXRpYyBpbnQgd204OTA0X3ByZXBhcmVfc3lzY2xrKHN0cnVjdCB3bTg5
MDRfcHJpdiAqcHJpdikKK3sKKwlpbnQgZXJyOworCisJc3dpdGNoIChwcml2LT5zeXNjbGtfc3Jj
KSB7CisJY2FzZSBXTTg5MDRfQ0xLX01DTEs6CisJCWVyciA9IGNsa19zZXRfcmF0ZShwcml2LT5t
Y2xrLCBwcml2LT5tY2xrX3JhdGUpOworCQlpZiAoIWVycikKKwkJCWVyciA9IGNsa19wcmVwYXJl
X2VuYWJsZShwcml2LT5tY2xrKTsKKwkJYnJlYWs7CisKKwljYXNlIFdNODkwNF9DTEtfRkxMOgor
CQllcnIgPSB3bV9mbGxfZW5hYmxlKCZwcml2LT5mbGwpOworCQlicmVhazsKKworCWRlZmF1bHQ6
CisJCWVyciA9IC1FSU5WQUw7CisJCWJyZWFrOworCX0KKworCXJldHVybiBlcnI7Cit9CisKK3N0
YXRpYyB2b2lkIHdtODkwNF9kaXNhYmxlX3N5c2NsayhzdHJ1Y3Qgd204OTA0X3ByaXYgKnByaXYp
Cit7CisJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgV004OTA0X0NMT0NLX1JBVEVT
XzIsCisJCQkgICBXTTg5MDRfQ0xLX1NZU19FTkEsIDApOworCXdtODkwNF91bnByZXBhcmVfc3lz
Y2xrKHByaXYpOworfQorCitzdGF0aWMgaW50IHdtODkwNF9lbmFibGVfc3lzY2xrKHN0cnVjdCB3
bTg5MDRfcHJpdiAqcHJpdikKK3sKKwlpbnQgZXJyOworCisJZXJyID0gd204OTA0X3ByZXBhcmVf
c3lzY2xrKHByaXYpOworCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJZXJyID0gcmVn
bWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgV004OTA0X0NMT0NLX1JBVEVTXzIsCisJCQkJ
IFdNODkwNF9DTEtfU1lTX0VOQV9NQVNLLCBXTTg5MDRfQ0xLX1NZU19FTkEpOworCWlmIChlcnIg
PCAwKQorCQl3bTg5MDRfdW5wcmVwYXJlX3N5c2Nsayhwcml2KTsKKworCXJldHVybiBlcnI7Cit9
CisKK3N0YXRpYyBpbnQgd204OTA0X3NldF9zeXNjbGsoc3RydWN0IHNuZF9zb2NfZGFpICpkYWks
IGludCBjbGtfaWQsCisJCQkgICAgIHVuc2lnbmVkIGludCByYXRlLCBpbnQgZGlyKQoreworCXN0
cnVjdCBzbmRfc29jX2NvbXBvbmVudCAqY29tcG9uZW50ID0gZGFpLT5jb21wb25lbnQ7CiAJc3Ry
dWN0IHdtODkwNF9wcml2ICp3bTg5MDQgPSBzbmRfc29jX2NvbXBvbmVudF9nZXRfZHJ2ZGF0YShj
b21wb25lbnQpOwotCXVuc2lnbmVkIGludCBjbG9jazAsIGNsb2NrMiwgcmF0ZTsKKwl1bnNpZ25l
ZCBpbnQgY2xvY2swLCBjbG9jazI7CisJaW50IGVycjsKKworCXN3aXRjaCAoY2xrX2lkKSB7CisJ
Y2FzZSBXTTg5MDRfQ0xLX01DTEs6CisJY2FzZSBXTTg5MDRfQ0xLX0ZMTDoKKwkJYnJlYWs7CisK
KwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwlpZiAoY2xrX2lkID09IHdtODkw
NC0+c3lzY2xrX3NyYyAmJiByYXRlID09IHdtODkwNC0+bWNsa19yYXRlKQorCQlyZXR1cm4gMDsK
KworCWRldl9kYmcoZGFpLT5kZXYsICJDbG9jayBzb3VyY2UgaXMgJWQgYXQgJXVIelxuIiwgY2xr
X2lkLCByYXRlKTsKIAogCS8qIEdhdGUgdGhlIGNsb2NrIHdoaWxlIHdlJ3JlIHVwZGF0aW5nIHRv
IGF2b2lkIG1pc2Nsb2NraW5nICovCiAJY2xvY2syID0gc25kX3NvY19jb21wb25lbnRfcmVhZDMy
KGNvbXBvbmVudCwgV004OTA0X0NMT0NLX1JBVEVTXzIpOwotCXNuZF9zb2NfY29tcG9uZW50X3Vw
ZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0NMT0NLX1JBVEVTXzIsCi0JCQkgICAgV004OTA0
X1NZU0NMS19TUkMsIDApOworCXdtODkwNF9kaXNhYmxlX3N5c2Nsayh3bTg5MDQpOworCisJd204
OTA0LT5zeXNjbGtfc3JjID0gY2xrX2lkOworCXdtODkwNC0+bWNsa19yYXRlID0gcmF0ZTsKIAot
CS8qIFRoaXMgc2hvdWxkIGJlIGRvbmUgb24gaW5pdCgpIGZvciBieXBhc3MgcGF0aHMgKi8KIAlz
d2l0Y2ggKHdtODkwNC0+c3lzY2xrX3NyYykgewogCWNhc2UgV004OTA0X0NMS19NQ0xLOgotCQlk
ZXZfZGJnKGNvbXBvbmVudC0+ZGV2LCAiVXNpbmcgJWRIeiBNQ0xLXG4iLCB3bTg5MDQtPm1jbGtf
cmF0ZSk7CisJCWRldl9kYmcoY29tcG9uZW50LT5kZXYsICJVc2luZyAlZEh6IE1DTEtcbiIsIHJh
dGUpOwogCiAJCWNsb2NrMiAmPSB+V004OTA0X1NZU0NMS19TUkM7Ci0JCXJhdGUgPSB3bTg5MDQt
Pm1jbGtfcmF0ZTsKLQotCQkvKiBFbnN1cmUgdGhlIEZMTCBpcyBzdG9wcGVkICovCi0JCXNuZF9z
b2NfY29tcG9uZW50X3VwZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0ZMTF9DT05UUk9MXzEs
Ci0JCQkJICAgIFdNODkwNF9GTExfT1NDX0VOQSB8IFdNODkwNF9GTExfRU5BLCAwKTsKIAkJYnJl
YWs7CiAKIAljYXNlIFdNODkwNF9DTEtfRkxMOgotCQlkZXZfZGJnKGNvbXBvbmVudC0+ZGV2LCAi
VXNpbmcgJWRIeiBGTEwgY2xvY2tcbiIsCi0JCQl3bTg5MDQtPmZsbF9mb3V0KTsKKwkJZXJyID0g
d21fZmxsX3NldF9yYXRlKCZ3bTg5MDQtPmZsbCwgcmF0ZSk7CisJCWlmIChlcnIgPCAwKQorCQkJ
cmV0dXJuIGVycjsKKworCQlkZXZfZGJnKGNvbXBvbmVudC0+ZGV2LCAiVXNpbmcgJWRIeiBGTEwg
Y2xvY2tcbiIsIHJhdGUpOwogCiAJCWNsb2NrMiB8PSBXTTg5MDRfU1lTQ0xLX1NSQzsKLQkJcmF0
ZSA9IHdtODkwNC0+ZmxsX2ZvdXQ7CiAJCWJyZWFrOwogCiAJZGVmYXVsdDoKQEAgLTM1NiwxMSAr
NDI3LDE4IEBAIHN0YXRpYyBpbnQgd204OTA0X2NvbmZpZ3VyZV9jbG9ja2luZyhzdHJ1Y3Qgc25k
X3NvY19jb21wb25lbnQgKmNvbXBvbmVudCkKIAkJd204OTA0LT5zeXNjbGtfcmF0ZSA9IHJhdGU7
CiAJfQogCi0Jc25kX3NvY19jb21wb25lbnRfdXBkYXRlX2JpdHMoY29tcG9uZW50LCBXTTg5MDRf
Q0xPQ0tfUkFURVNfMCwgV004OTA0X01DTEtfRElWLAotCQkJICAgIGNsb2NrMCk7Ci0KKwlzbmRf
c29jX2NvbXBvbmVudF91cGRhdGVfYml0cyhjb21wb25lbnQsIFdNODkwNF9DTE9DS19SQVRFU18w
LAorCQkJCSAgICAgIFdNODkwNF9NQ0xLX0RJViwgY2xvY2swKTsKIAlzbmRfc29jX2NvbXBvbmVu
dF91cGRhdGVfYml0cyhjb21wb25lbnQsIFdNODkwNF9DTE9DS19SQVRFU18yLAotCQkJICAgIFdN
ODkwNF9DTEtfU1lTX0VOQSB8IFdNODkwNF9TWVNDTEtfU1JDLCBjbG9jazIpOworCQkJCSAgICAg
IFdNODkwNF9TWVNDTEtfU1JDLCBjbG9jazIpOworCisJaWYgKGNsb2NrMiAmIFdNODkwNF9DTEtf
U1lTX0VOQSkgeworCQllcnIgPSB3bTg5MDRfZW5hYmxlX3N5c2Nsayh3bTg5MDQpOworCQlpZiAo
ZXJyIDwgMCkgeworCQkJZGV2X2Vycihjb21wb25lbnQtPmRldiwgIkZhaWxlZCB0byByZWVuYWJs
ZSBDTEtfU1lTOiAlZFxuIiwgZXJyKTsKKwkJCXJldHVybiBlcnI7CisJCX0KKwl9CiAKIAlkZXZf
ZGJnKGNvbXBvbmVudC0+ZGV2LCAiQ0xLX1NZUyBpcyAlZEh6XG4iLCB3bTg5MDQtPnN5c2Nsa19y
YXRlKTsKIApAQCAtNjcwLDMzICs3NDgsMjEgQEAgc3RhdGljIGludCBzeXNjbGtfZXZlbnQoc3Ry
dWN0IHNuZF9zb2NfZGFwbV93aWRnZXQgKncsCiB7CiAJc3RydWN0IHNuZF9zb2NfY29tcG9uZW50
ICpjb21wb25lbnQgPSBzbmRfc29jX2RhcG1fdG9fY29tcG9uZW50KHctPmRhcG0pOwogCXN0cnVj
dCB3bTg5MDRfcHJpdiAqd204OTA0ID0gc25kX3NvY19jb21wb25lbnRfZ2V0X2RydmRhdGEoY29t
cG9uZW50KTsKKwlpbnQgcmV0ID0gMDsKIAogCXN3aXRjaCAoZXZlbnQpIHsKIAljYXNlIFNORF9T
T0NfREFQTV9QUkVfUE1VOgotCQkvKiBJZiB3ZSdyZSB1c2luZyB0aGUgRkxMIHRoZW4gd2Ugb25s
eSBzdGFydCBpdCB3aGVuCi0JCSAqIHJlcXVpcmVkOyB3ZSBhc3N1bWUgdGhhdCB0aGUgY29uZmln
dXJhdGlvbiBoYXMgYmVlbgotCQkgKiBkb25lIHByZXZpb3VzbHkgYW5kIGFsbCB3ZSBuZWVkIHRv
IGRvIGlzIGtpY2sgaXQKLQkJICogb2ZmLgotCQkgKi8KLQkJc3dpdGNoICh3bTg5MDQtPnN5c2Ns
a19zcmMpIHsKLQkJY2FzZSBXTTg5MDRfQ0xLX0ZMTDoKLQkJCXNuZF9zb2NfY29tcG9uZW50X3Vw
ZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0ZMTF9DT05UUk9MXzEsCi0JCQkJCSAgICBXTTg5
MDRfRkxMX09TQ19FTkEsCi0JCQkJCSAgICBXTTg5MDRfRkxMX09TQ19FTkEpOwotCi0JCQlzbmRf
c29jX2NvbXBvbmVudF91cGRhdGVfYml0cyhjb21wb25lbnQsIFdNODkwNF9GTExfQ09OVFJPTF8x
LAotCQkJCQkgICAgV004OTA0X0ZMTF9FTkEsCi0JCQkJCSAgICBXTTg5MDRfRkxMX0VOQSk7Ci0J
CQlicmVhazsKLQotCQlkZWZhdWx0OgotCQkJYnJlYWs7Ci0JCX0KKwkJcmV0ID0gd204OTA0X3By
ZXBhcmVfc3lzY2xrKHdtODkwNCk7CisJCWlmIChyZXQpCisJCQlkZXZfZXJyKGNvbXBvbmVudC0+
ZGV2LAorCQkJCSJGYWlsZWQgdG8gcHJlcGFyZSBTWVNDTEs6ICVkXG4iLCByZXQpOworCQllbHNl
CisJCQlkZXZfZGJnKGNvbXBvbmVudC0+ZGV2LCAiU1lTQ0xLIG9uXG4iKTsKIAkJYnJlYWs7CiAK
IAljYXNlIFNORF9TT0NfREFQTV9QT1NUX1BNRDoKLQkJc25kX3NvY19jb21wb25lbnRfdXBkYXRl
X2JpdHMoY29tcG9uZW50LCBXTTg5MDRfRkxMX0NPTlRST0xfMSwKLQkJCQkgICAgV004OTA0X0ZM
TF9PU0NfRU5BIHwgV004OTA0X0ZMTF9FTkEsIDApOworCQl3bTg5MDRfdW5wcmVwYXJlX3N5c2Ns
ayh3bTg5MDQpOworCQlkZXZfZGJnKGNvbXBvbmVudC0+ZGV2LCAiU1lTQ0xLIG9mZlxuIik7CiAJ
CWJyZWFrOwogCX0KIApAQCAtMTI3NSw3ICsxMzQxLDcgQEAgc3RhdGljIGludCB3bTg5MDRfaHdf
cGFyYW1zKHN0cnVjdCBzbmRfcGNtX3N1YnN0cmVhbSAqc3Vic3RyZWFtLAogewogCXN0cnVjdCBz
bmRfc29jX2NvbXBvbmVudCAqY29tcG9uZW50ID0gZGFpLT5jb21wb25lbnQ7CiAJc3RydWN0IHdt
ODkwNF9wcml2ICp3bTg5MDQgPSBzbmRfc29jX2NvbXBvbmVudF9nZXRfZHJ2ZGF0YShjb21wb25l
bnQpOwotCWludCByZXQsIGksIGJlc3QsIGJlc3RfdmFsLCBjdXJfdmFsOworCWludCBpLCBiZXN0
LCBiZXN0X3ZhbCwgY3VyX3ZhbDsKIAl1bnNpZ25lZCBpbnQgYWlmMSA9IDA7CiAJdW5zaWduZWQg
aW50IGFpZjIgPSAwOwogCXVuc2lnbmVkIGludCBhaWYzID0gMDsKQEAgLTEzMTAsMTMgKzEzNzYs
OCBAQCBzdGF0aWMgaW50IHdtODkwNF9od19wYXJhbXMoc3RydWN0IHNuZF9wY21fc3Vic3RyZWFt
ICpzdWJzdHJlYW0sCiAJCXJldHVybiAtRUlOVkFMOwogCX0KIAotCiAJZGV2X2RiZyhjb21wb25l
bnQtPmRldiwgIlRhcmdldCBCQ0xLIGlzICVkSHpcbiIsIHdtODkwNC0+YmNsayk7CiAKLQlyZXQg
PSB3bTg5MDRfY29uZmlndXJlX2Nsb2NraW5nKGNvbXBvbmVudCk7Ci0JaWYgKHJldCAhPSAwKQot
CQlyZXR1cm4gcmV0OwotCiAJLyogU2VsZWN0IG5lYXJlc3QgQ0xLX1NZU19SQVRFICovCiAJYmVz
dCA9IDA7CiAJYmVzdF92YWwgPSBhYnMoKHdtODkwNC0+c3lzY2xrX3JhdGUgLyBjbGtfc3lzX3Jh
dGVzWzBdLnJhdGlvKQpAQCAtMTM2OCw4ICsxNDI5LDggQEAgc3RhdGljIGludCB3bTg5MDRfaHdf
cGFyYW1zKHN0cnVjdCBzbmRfcGNtX3N1YnN0cmVhbSAqc3Vic3RyZWFtLAogCQl9CiAJfQogCXdt
ODkwNC0+YmNsayA9ICh3bTg5MDQtPnN5c2Nsa19yYXRlICogMTApIC8gYmNsa19kaXZzW2Jlc3Rd
LmRpdjsKLQlkZXZfZGJnKGNvbXBvbmVudC0+ZGV2LCAiU2VsZWN0ZWQgQkNMS19ESVYgb2YgJWQg
Zm9yICVkSHogQkNMS1xuIiwKLQkJYmNsa19kaXZzW2Jlc3RdLmRpdiwgd204OTA0LT5iY2xrKTsK
KwlkZXZfZGJnKGNvbXBvbmVudC0+ZGV2LCAiU2VsZWN0ZWQgQkNMS19ESVYgb2YgJWQuJWQgZm9y
ICVkSHogQkNMS1xuIiwKKwkJYmNsa19kaXZzW2Jlc3RdLmRpdiAvIDEwLCBiY2xrX2RpdnNbYmVz
dF0uZGl2ICUgMTAsICB3bTg5MDQtPmJjbGspOwogCWFpZjIgfD0gYmNsa19kaXZzW2Jlc3RdLmJj
bGtfZGl2OwogCiAJLyogTFJDTEsgaXMgYSBzaW1wbGUgZnJhY3Rpb24gb2YgQkNMSyAqLwpAQCAt
MTM5NiwzNCArMTQ1Nyw2IEBAIHN0YXRpYyBpbnQgd204OTA0X2h3X3BhcmFtcyhzdHJ1Y3Qgc25k
X3BjbV9zdWJzdHJlYW0gKnN1YnN0cmVhbSwKIAlyZXR1cm4gMDsKIH0KIAotCi1zdGF0aWMgaW50
IHdtODkwNF9zZXRfc3lzY2xrKHN0cnVjdCBzbmRfc29jX2RhaSAqZGFpLCBpbnQgY2xrX2lkLAot
CQkJICAgICB1bnNpZ25lZCBpbnQgZnJlcSwgaW50IGRpcikKLXsKLQlzdHJ1Y3Qgc25kX3NvY19j
b21wb25lbnQgKmNvbXBvbmVudCA9IGRhaS0+Y29tcG9uZW50OwotCXN0cnVjdCB3bTg5MDRfcHJp
diAqcHJpdiA9IHNuZF9zb2NfY29tcG9uZW50X2dldF9kcnZkYXRhKGNvbXBvbmVudCk7Ci0KLQlz
d2l0Y2ggKGNsa19pZCkgewotCWNhc2UgV004OTA0X0NMS19NQ0xLOgotCQlwcml2LT5zeXNjbGtf
c3JjID0gY2xrX2lkOwotCQlwcml2LT5tY2xrX3JhdGUgPSBmcmVxOwotCQlicmVhazsKLQotCWNh
c2UgV004OTA0X0NMS19GTEw6Ci0JCXByaXYtPnN5c2Nsa19zcmMgPSBjbGtfaWQ7Ci0JCWJyZWFr
OwotCi0JZGVmYXVsdDoKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JfQotCi0JZGV2X2RiZyhkYWktPmRl
diwgIkNsb2NrIHNvdXJjZSBpcyAlZCBhdCAldUh6XG4iLCBjbGtfaWQsIGZyZXEpOwotCi0Jd204
OTA0X2NvbmZpZ3VyZV9jbG9ja2luZyhjb21wb25lbnQpOwotCi0JcmV0dXJuIDA7Ci19Ci0KIHN0
YXRpYyBpbnQgd204OTA0X3NldF9mbXQoc3RydWN0IHNuZF9zb2NfZGFpICpkYWksIHVuc2lnbmVk
IGludCBmbXQpCiB7CiAJc3RydWN0IHNuZF9zb2NfY29tcG9uZW50ICpjb21wb25lbnQgPSBkYWkt
PmNvbXBvbmVudDsKQEAgLTE1NjMsMjUzICsxNTk2LDYgQEAgc3RhdGljIGludCB3bTg5MDRfc2V0
X3RkbV9zbG90KHN0cnVjdCBzbmRfc29jX2RhaSAqZGFpLCB1bnNpZ25lZCBpbnQgdHhfbWFzaywK
IAlyZXR1cm4gMDsKIH0KIAotc3RydWN0IF9mbGxfZGl2IHsKLQl1MTYgZmxsX2ZyYXRpbzsKLQl1
MTYgZmxsX291dGRpdjsKLQl1MTYgZmxsX2Nsa19yZWZfZGl2OwotCXUxNiBuOwotCXUxNiBrOwot
fTsKLQotLyogVGhlIHNpemUgaW4gYml0cyBvZiB0aGUgRkxMIGRpdmlkZSBtdWx0aXBsaWVkIGJ5
IDEwCi0gKiB0byBhbGxvdyByb3VuZGluZyBsYXRlciAqLwotI2RlZmluZSBGSVhFRF9GTExfU0la
RSAoKDEgPDwgMTYpICogMTApCi0KLXN0YXRpYyBzdHJ1Y3QgewotCXVuc2lnbmVkIGludCBtaW47
Ci0JdW5zaWduZWQgaW50IG1heDsKLQl1MTYgZmxsX2ZyYXRpbzsKLQlpbnQgcmF0aW87Ci19IGZs
bF9mcmF0aW9zW10gPSB7Ci0JeyAgICAgICAwLCAgICA2NDAwMCwgNCwgMTYgfSwKLQl7ICAgNjQw
MDAsICAgMTI4MDAwLCAzLCAgOCB9LAotCXsgIDEyODAwMCwgICAyNTYwMDAsIDIsICA0IH0sCi0J
eyAgMjU2MDAwLCAgMTAwMDAwMCwgMSwgIDIgfSwKLQl7IDEwMDAwMDAsIDEzNTAwMDAwLCAwLCAg
MSB9LAotfTsKLQotc3RhdGljIGludCBmbGxfZmFjdG9ycyhzdHJ1Y3QgX2ZsbF9kaXYgKmZsbF9k
aXYsIHVuc2lnbmVkIGludCBGcmVmLAotCQkgICAgICAgdW5zaWduZWQgaW50IEZvdXQpCi17Ci0J
dTY0IEtwYXJ0OwotCXVuc2lnbmVkIGludCBLLCBOZGl2LCBObW9kLCB0YXJnZXQ7Ci0JdW5zaWdu
ZWQgaW50IGRpdjsKLQlpbnQgaTsKLQotCS8qIEZyZWYgbXVzdCBiZSA8PTEzLjVNSHogKi8KLQlk
aXYgPSAxOwotCWZsbF9kaXYtPmZsbF9jbGtfcmVmX2RpdiA9IDA7Ci0Jd2hpbGUgKChGcmVmIC8g
ZGl2KSA+IDEzNTAwMDAwKSB7Ci0JCWRpdiAqPSAyOwotCQlmbGxfZGl2LT5mbGxfY2xrX3JlZl9k
aXYrKzsKLQotCQlpZiAoZGl2ID4gOCkgewotCQkJcHJfZXJyKCJDYW4ndCBzY2FsZSAlZE1IeiBp
bnB1dCBkb3duIHRvIDw9MTMuNU1IelxuIiwKLQkJCSAgICAgICBGcmVmKTsKLQkJCXJldHVybiAt
RUlOVkFMOwotCQl9Ci0JfQotCi0JcHJfZGVidWcoIkZyZWY9JXUgRm91dD0ldVxuIiwgRnJlZiwg
Rm91dCk7Ci0KLQkvKiBBcHBseSB0aGUgZGl2aXNpb24gZm9yIG91ciByZW1haW5pbmcgY2FsY3Vs
YXRpb25zICovCi0JRnJlZiAvPSBkaXY7Ci0KLQkvKiBGdmNvIHNob3VsZCBiZSA5MC0xMDBNSHo7
IGRvbid0IGNoZWNrIHRoZSB1cHBlciBib3VuZCAqLwotCWRpdiA9IDQ7Ci0Jd2hpbGUgKEZvdXQg
KiBkaXYgPCA5MDAwMDAwMCkgewotCQlkaXYrKzsKLQkJaWYgKGRpdiA+IDY0KSB7Ci0JCQlwcl9l
cnIoIlVuYWJsZSB0byBmaW5kIEZMTF9PVVRESVYgZm9yIEZvdXQ9JXVIelxuIiwKLQkJCSAgICAg
ICBGb3V0KTsKLQkJCXJldHVybiAtRUlOVkFMOwotCQl9Ci0JfQotCXRhcmdldCA9IEZvdXQgKiBk
aXY7Ci0JZmxsX2Rpdi0+ZmxsX291dGRpdiA9IGRpdiAtIDE7Ci0KLQlwcl9kZWJ1ZygiRnZjbz0l
ZEh6XG4iLCB0YXJnZXQpOwotCi0JLyogRmluZCBhbiBhcHByb3ByaWF0ZSBGTExfRlJBVElPIGFu
ZCBmYWN0b3IgaXQgb3V0IG9mIHRoZSB0YXJnZXQgKi8KLQlmb3IgKGkgPSAwOyBpIDwgQVJSQVlf
U0laRShmbGxfZnJhdGlvcyk7IGkrKykgewotCQlpZiAoZmxsX2ZyYXRpb3NbaV0ubWluIDw9IEZy
ZWYgJiYgRnJlZiA8PSBmbGxfZnJhdGlvc1tpXS5tYXgpIHsKLQkJCWZsbF9kaXYtPmZsbF9mcmF0
aW8gPSBmbGxfZnJhdGlvc1tpXS5mbGxfZnJhdGlvOwotCQkJdGFyZ2V0IC89IGZsbF9mcmF0aW9z
W2ldLnJhdGlvOwotCQkJYnJlYWs7Ci0JCX0KLQl9Ci0JaWYgKGkgPT0gQVJSQVlfU0laRShmbGxf
ZnJhdGlvcykpIHsKLQkJcHJfZXJyKCJVbmFibGUgdG8gZmluZCBGTExfRlJBVElPIGZvciBGcmVm
PSV1SHpcbiIsIEZyZWYpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9Ci0KLQkvKiBOb3csIGNhbGN1
bGF0ZSBOLksgKi8KLQlOZGl2ID0gdGFyZ2V0IC8gRnJlZjsKLQotCWZsbF9kaXYtPm4gPSBOZGl2
OwotCU5tb2QgPSB0YXJnZXQgJSBGcmVmOwotCXByX2RlYnVnKCJObW9kPSVkXG4iLCBObW9kKTsK
LQotCS8qIENhbGN1bGF0ZSBmcmFjdGlvbmFsIHBhcnQgLSBzY2FsZSB1cCBzbyB3ZSBjYW4gcm91
bmQuICovCi0JS3BhcnQgPSBGSVhFRF9GTExfU0laRSAqIChsb25nIGxvbmcpTm1vZDsKLQotCWRv
X2RpdihLcGFydCwgRnJlZik7Ci0KLQlLID0gS3BhcnQgJiAweEZGRkZGRkZGOwotCi0JaWYgKChL
ICUgMTApID49IDUpCi0JCUsgKz0gNTsKLQotCS8qIE1vdmUgZG93biB0byBwcm9wZXIgcmFuZ2Ug
bm93IHJvdW5kaW5nIGlzIGRvbmUgKi8KLQlmbGxfZGl2LT5rID0gSyAvIDEwOwotCi0JcHJfZGVi
dWcoIk49JXggSz0leCBGTExfRlJBVElPPSV4IEZMTF9PVVRESVY9JXggRkxMX0NMS19SRUZfRElW
PSV4XG4iLAotCQkgZmxsX2Rpdi0+biwgZmxsX2Rpdi0+aywKLQkJIGZsbF9kaXYtPmZsbF9mcmF0
aW8sIGZsbF9kaXYtPmZsbF9vdXRkaXYsCi0JCSBmbGxfZGl2LT5mbGxfY2xrX3JlZl9kaXYpOwot
Ci0JcmV0dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbnQgd204OTA0X3NldF9mbGwoc3RydWN0IHNuZF9z
b2NfZGFpICpkYWksIGludCBmbGxfaWQsIGludCBzb3VyY2UsCi0JCQkgIHVuc2lnbmVkIGludCBG
cmVmLCB1bnNpZ25lZCBpbnQgRm91dCkKLXsKLQlzdHJ1Y3Qgc25kX3NvY19jb21wb25lbnQgKmNv
bXBvbmVudCA9IGRhaS0+Y29tcG9uZW50OwotCXN0cnVjdCB3bTg5MDRfcHJpdiAqd204OTA0ID0g
c25kX3NvY19jb21wb25lbnRfZ2V0X2RydmRhdGEoY29tcG9uZW50KTsKLQlzdHJ1Y3QgX2ZsbF9k
aXYgZmxsX2RpdjsKLQlpbnQgcmV0LCB2YWw7Ci0JaW50IGNsb2NrMiwgZmxsMTsKLQotCS8qIEFu
eSBjaGFuZ2U/ICovCi0JaWYgKHNvdXJjZSA9PSB3bTg5MDQtPmZsbF9zcmMgJiYgRnJlZiA9PSB3
bTg5MDQtPmZsbF9mcmVmICYmCi0JICAgIEZvdXQgPT0gd204OTA0LT5mbGxfZm91dCkKLQkJcmV0
dXJuIDA7Ci0KLQljbG9jazIgPSBzbmRfc29jX2NvbXBvbmVudF9yZWFkMzIoY29tcG9uZW50LCBX
TTg5MDRfQ0xPQ0tfUkFURVNfMik7Ci0KLQlpZiAoRm91dCA9PSAwKSB7Ci0JCWRldl9kYmcoY29t
cG9uZW50LT5kZXYsICJGTEwgZGlzYWJsZWRcbiIpOwotCi0JCXdtODkwNC0+ZmxsX2ZyZWYgPSAw
OwotCQl3bTg5MDQtPmZsbF9mb3V0ID0gMDsKLQotCQkvKiBHYXRlIFNZU0NMSyB0byBhdm9pZCBn
bGl0Y2hlcyAqLwotCQlzbmRfc29jX2NvbXBvbmVudF91cGRhdGVfYml0cyhjb21wb25lbnQsIFdN
ODkwNF9DTE9DS19SQVRFU18yLAotCQkJCSAgICBXTTg5MDRfQ0xLX1NZU19FTkEsIDApOwotCi0J
CXNuZF9zb2NfY29tcG9uZW50X3VwZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0ZMTF9DT05U
Uk9MXzEsCi0JCQkJICAgIFdNODkwNF9GTExfT1NDX0VOQSB8IFdNODkwNF9GTExfRU5BLCAwKTsK
LQotCQlnb3RvIG91dDsKLQl9Ci0KLQkvKiBWYWxpZGF0ZSB0aGUgRkxMIElEICovCi0Jc3dpdGNo
IChzb3VyY2UpIHsKLQljYXNlIFdNODkwNF9GTExfTUNMSzoKLQljYXNlIFdNODkwNF9GTExfTFJD
TEs6Ci0JY2FzZSBXTTg5MDRfRkxMX0JDTEs6Ci0JCXJldCA9IGZsbF9mYWN0b3JzKCZmbGxfZGl2
LCBGcmVmLCBGb3V0KTsKLQkJaWYgKHJldCAhPSAwKQotCQkJcmV0dXJuIHJldDsKLQkJYnJlYWs7
Ci0KLQljYXNlIFdNODkwNF9GTExfRlJFRV9SVU5OSU5HOgotCQlkZXZfZGJnKGNvbXBvbmVudC0+
ZGV2LCAiVXNpbmcgZnJlZSBydW5uaW5nIEZMTFxuIik7Ci0JCS8qIEZvcmNlIDEyTUh6IGFuZCBv
dXRwdXQvNCBmb3Igbm93ICovCi0JCUZvdXQgPSAxMjAwMDAwMDsKLQkJRnJlZiA9IDEyMDAwMDAw
OwotCi0JCW1lbXNldCgmZmxsX2RpdiwgMCwgc2l6ZW9mKGZsbF9kaXYpKTsKLQkJZmxsX2Rpdi5m
bGxfb3V0ZGl2ID0gMzsKLQkJYnJlYWs7Ci0KLQlkZWZhdWx0OgotCQlkZXZfZXJyKGNvbXBvbmVu
dC0+ZGV2LCAiVW5rbm93biBGTEwgSUQgJWRcbiIsIGZsbF9pZCk7Ci0JCXJldHVybiAtRUlOVkFM
OwotCX0KLQotCS8qIFNhdmUgY3VycmVudCBzdGF0ZSB0aGVuIGRpc2FibGUgdGhlIEZMTCBhbmQg
U1lTQ0xLIHRvIGF2b2lkCi0JICogbWlzY2xvY2tpbmcgKi8KLQlmbGwxID0gc25kX3NvY19jb21w
b25lbnRfcmVhZDMyKGNvbXBvbmVudCwgV004OTA0X0ZMTF9DT05UUk9MXzEpOwotCXNuZF9zb2Nf
Y29tcG9uZW50X3VwZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0NMT0NLX1JBVEVTXzIsCi0J
CQkgICAgV004OTA0X0NMS19TWVNfRU5BLCAwKTsKLQlzbmRfc29jX2NvbXBvbmVudF91cGRhdGVf
Yml0cyhjb21wb25lbnQsIFdNODkwNF9GTExfQ09OVFJPTF8xLAotCQkJICAgIFdNODkwNF9GTExf
T1NDX0VOQSB8IFdNODkwNF9GTExfRU5BLCAwKTsKLQotCS8qIFVubG9jayBmb3JjZWQgb3NjaWxh
dG9yIGNvbnRyb2wgdG8gc3dpdGNoIGl0IG9uL29mZiAqLwotCXNuZF9zb2NfY29tcG9uZW50X3Vw
ZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0NPTlRST0xfSU5URVJGQUNFX1RFU1RfMSwKLQkJ
CSAgICBXTTg5MDRfVVNFUl9LRVksIFdNODkwNF9VU0VSX0tFWSk7Ci0KLQlpZiAoZmxsX2lkID09
IFdNODkwNF9GTExfRlJFRV9SVU5OSU5HKSB7Ci0JCXZhbCA9IFdNODkwNF9GTExfRlJDX05DTzsK
LQl9IGVsc2UgewotCQl2YWwgPSAwOwotCX0KLQotCXNuZF9zb2NfY29tcG9uZW50X3VwZGF0ZV9i
aXRzKGNvbXBvbmVudCwgV004OTA0X0ZMTF9OQ09fVEVTVF8xLCBXTTg5MDRfRkxMX0ZSQ19OQ08s
Ci0JCQkgICAgdmFsKTsKLQlzbmRfc29jX2NvbXBvbmVudF91cGRhdGVfYml0cyhjb21wb25lbnQs
IFdNODkwNF9DT05UUk9MX0lOVEVSRkFDRV9URVNUXzEsCi0JCQkgICAgV004OTA0X1VTRVJfS0VZ
LCAwKTsKLQotCXN3aXRjaCAoZmxsX2lkKSB7Ci0JY2FzZSBXTTg5MDRfRkxMX01DTEs6Ci0JCXNu
ZF9zb2NfY29tcG9uZW50X3VwZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0ZMTF9DT05UUk9M
XzUsCi0JCQkJICAgIFdNODkwNF9GTExfQ0xLX1JFRl9TUkNfTUFTSywgMCk7Ci0JCWJyZWFrOwot
Ci0JY2FzZSBXTTg5MDRfRkxMX0xSQ0xLOgotCQlzbmRfc29jX2NvbXBvbmVudF91cGRhdGVfYml0
cyhjb21wb25lbnQsIFdNODkwNF9GTExfQ09OVFJPTF81LAotCQkJCSAgICBXTTg5MDRfRkxMX0NM
S19SRUZfU1JDX01BU0ssIDEpOwotCQlicmVhazsKLQotCWNhc2UgV004OTA0X0ZMTF9CQ0xLOgot
CQlzbmRfc29jX2NvbXBvbmVudF91cGRhdGVfYml0cyhjb21wb25lbnQsIFdNODkwNF9GTExfQ09O
VFJPTF81LAotCQkJCSAgICBXTTg5MDRfRkxMX0NMS19SRUZfU1JDX01BU0ssIDIpOwotCQlicmVh
azsKLQl9Ci0KLQlpZiAoZmxsX2Rpdi5rKQotCQl2YWwgPSBXTTg5MDRfRkxMX0ZSQUNOX0VOQTsK
LQllbHNlCi0JCXZhbCA9IDA7Ci0Jc25kX3NvY19jb21wb25lbnRfdXBkYXRlX2JpdHMoY29tcG9u
ZW50LCBXTTg5MDRfRkxMX0NPTlRST0xfMSwKLQkJCSAgICBXTTg5MDRfRkxMX0ZSQUNOX0VOQSwg
dmFsKTsKLQotCXNuZF9zb2NfY29tcG9uZW50X3VwZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0
X0ZMTF9DT05UUk9MXzIsCi0JCQkgICAgV004OTA0X0ZMTF9PVVRESVZfTUFTSyB8IFdNODkwNF9G
TExfRlJBVElPX01BU0ssCi0JCQkgICAgKGZsbF9kaXYuZmxsX291dGRpdiA8PCBXTTg5MDRfRkxM
X09VVERJVl9TSElGVCkgfAotCQkJICAgIChmbGxfZGl2LmZsbF9mcmF0aW8gPDwgV004OTA0X0ZM
TF9GUkFUSU9fU0hJRlQpKTsKLQotCXNuZF9zb2NfY29tcG9uZW50X3dyaXRlKGNvbXBvbmVudCwg
V004OTA0X0ZMTF9DT05UUk9MXzMsIGZsbF9kaXYuayk7Ci0KLQlzbmRfc29jX2NvbXBvbmVudF91
cGRhdGVfYml0cyhjb21wb25lbnQsIFdNODkwNF9GTExfQ09OVFJPTF80LCBXTTg5MDRfRkxMX05f
TUFTSywKLQkJCSAgICBmbGxfZGl2Lm4gPDwgV004OTA0X0ZMTF9OX1NISUZUKTsKLQotCXNuZF9z
b2NfY29tcG9uZW50X3VwZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0ZMTF9DT05UUk9MXzUs
Ci0JCQkgICAgV004OTA0X0ZMTF9DTEtfUkVGX0RJVl9NQVNLLAotCQkJICAgIGZsbF9kaXYuZmxs
X2Nsa19yZWZfZGl2IAotCQkJICAgIDw8IFdNODkwNF9GTExfQ0xLX1JFRl9ESVZfU0hJRlQpOwot
Ci0JZGV2X2RiZyhjb21wb25lbnQtPmRldiwgIkZMTCBjb25maWd1cmVkIGZvciAlZEh6LT4lZEh6
XG4iLCBGcmVmLCBGb3V0KTsKLQotCXdtODkwNC0+ZmxsX2ZyZWYgPSBGcmVmOwotCXdtODkwNC0+
ZmxsX2ZvdXQgPSBGb3V0OwotCXdtODkwNC0+ZmxsX3NyYyA9IHNvdXJjZTsKLQotCS8qIEVuYWJs
ZSB0aGUgRkxMIGlmIGl0IHdhcyBwcmV2aW91c2x5IGFjdGl2ZSAqLwotCXNuZF9zb2NfY29tcG9u
ZW50X3VwZGF0ZV9iaXRzKGNvbXBvbmVudCwgV004OTA0X0ZMTF9DT05UUk9MXzEsCi0JCQkgICAg
V004OTA0X0ZMTF9PU0NfRU5BLCBmbGwxKTsKLQlzbmRfc29jX2NvbXBvbmVudF91cGRhdGVfYml0
cyhjb21wb25lbnQsIFdNODkwNF9GTExfQ09OVFJPTF8xLAotCQkJICAgIFdNODkwNF9GTExfRU5B
LCBmbGwxKTsKLQotb3V0OgotCS8qIFJlZW5hYmxlIFNZU0NMSyBpZiBpdCB3YXMgcHJldmlvdXNs
eSBhY3RpdmUgKi8KLQlzbmRfc29jX2NvbXBvbmVudF91cGRhdGVfYml0cyhjb21wb25lbnQsIFdN
ODkwNF9DTE9DS19SQVRFU18yLAotCQkJICAgIFdNODkwNF9DTEtfU1lTX0VOQSwgY2xvY2syKTsK
LQotCXJldHVybiAwOwotfQotCiBzdGF0aWMgaW50IHdtODkwNF9kaWdpdGFsX211dGUoc3RydWN0
IHNuZF9zb2NfZGFpICpjb2RlY19kYWksIGludCBtdXRlKQogewogCXN0cnVjdCBzbmRfc29jX2Nv
bXBvbmVudCAqY29tcG9uZW50ID0gY29kZWNfZGFpLT5jb21wb25lbnQ7CkBAIC0xODU3LDE1ICsx
NjQzLDYgQEAgc3RhdGljIGludCB3bTg5MDRfc2V0X2JpYXNfbGV2ZWwoc3RydWN0IHNuZF9zb2Nf
Y29tcG9uZW50ICpjb21wb25lbnQsCiAJCQkJcmV0dXJuIHJldDsKIAkJCX0KIAotCQkJcmV0ID0g
Y2xrX3ByZXBhcmVfZW5hYmxlKHdtODkwNC0+bWNsayk7Ci0JCQlpZiAocmV0KSB7Ci0JCQkJZGV2
X2Vycihjb21wb25lbnQtPmRldiwKLQkJCQkJIkZhaWxlZCB0byBlbmFibGUgTUNMSzogJWRcbiIs
IHJldCk7Ci0JCQkJcmVndWxhdG9yX2J1bGtfZGlzYWJsZShBUlJBWV9TSVpFKHdtODkwNC0+c3Vw
cGxpZXMpLAotCQkJCQkJICAgICAgIHdtODkwNC0+c3VwcGxpZXMpOwotCQkJCXJldHVybiByZXQ7
Ci0JCQl9Ci0KIAkJCXJlZ2NhY2hlX2NhY2hlX29ubHkod204OTA0LT5yZWdtYXAsIGZhbHNlKTsK
IAkJCXJlZ2NhY2hlX3N5bmMod204OTA0LT5yZWdtYXApOwogCkBAIC0xOTA4LDcgKzE2ODUsNiBA
QCBzdGF0aWMgaW50IHdtODkwNF9zZXRfYmlhc19sZXZlbChzdHJ1Y3Qgc25kX3NvY19jb21wb25l
bnQgKmNvbXBvbmVudCwKIAogCQlyZWd1bGF0b3JfYnVsa19kaXNhYmxlKEFSUkFZX1NJWkUod204
OTA0LT5zdXBwbGllcyksCiAJCQkJICAgICAgIHdtODkwNC0+c3VwcGxpZXMpOwotCQljbGtfZGlz
YWJsZV91bnByZXBhcmUod204OTA0LT5tY2xrKTsKIAkJYnJlYWs7CiAJfQogCXJldHVybiAwOwpA
QCAtMTkyMyw3ICsxNjk5LDYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBzbmRfc29jX2RhaV9vcHMg
d204OTA0X2RhaV9vcHMgPSB7CiAJLnNldF9zeXNjbGsgPSB3bTg5MDRfc2V0X3N5c2NsaywKIAku
c2V0X2ZtdCA9IHdtODkwNF9zZXRfZm10LAogCS5zZXRfdGRtX3Nsb3QgPSB3bTg5MDRfc2V0X3Rk
bV9zbG90LAotCS5zZXRfcGxsID0gd204OTA0X3NldF9mbGwsCiAJLmh3X3BhcmFtcyA9IHdtODkw
NF9od19wYXJhbXMsCiAJLmRpZ2l0YWxfbXV0ZSA9IHdtODkwNF9kaWdpdGFsX211dGUsCiB9OwpA
QCAtMjE1MSw2ICsxOTI2LDggQEAgc3RhdGljIGludCB3bTg5MDRfaTJjX3Byb2JlKHN0cnVjdCBp
MmNfY2xpZW50ICppMmMsCiAJCXJldHVybiByZXQ7CiAJfQogCisJd21fZmxsX2luaXQoJndtODkw
NC0+ZmxsLCAmaTJjLT5kZXYpOworCiAJaWYgKGkyYy0+ZGV2Lm9mX25vZGUpIHsKIAkJY29uc3Qg
c3RydWN0IG9mX2RldmljZV9pZCAqbWF0Y2g7CiAKQEAgLTIyNjIsNiArMjAzOSw3IEBAIHN0YXRp
YyBpbnQgd204OTA0X2kyY19wcm9iZShzdHJ1Y3QgaTJjX2NsaWVudCAqaTJjLAogCQkJICAgIFdN
ODkwNF9QT0JDVFJMLCAwKTsKIAogCS8qIENhbiBsZWF2ZSB0aGUgZGV2aWNlIHBvd2VyZWQgb2Zm
IHVudGlsIHdlIG5lZWQgaXQgKi8KKwl3bTg5MDRfZGlzYWJsZV9zeXNjbGsod204OTA0KTsKIAly
ZWdjYWNoZV9jYWNoZV9vbmx5KHdtODkwNC0+cmVnbWFwLCB0cnVlKTsKIAlyZWd1bGF0b3JfYnVs
a19kaXNhYmxlKEFSUkFZX1NJWkUod204OTA0LT5zdXBwbGllcyksIHdtODkwNC0+c3VwcGxpZXMp
OwogCmRpZmYgLS1naXQgYS9zb3VuZC9zb2MvY29kZWNzL3dtODkwNC5oIGIvc291bmQvc29jL2Nv
ZGVjcy93bTg5MDQuaAppbmRleCBjMWJjYTUyZjk5MjcuLjYwYWYwOWUwYmIxNSAxMDA2NDQKLS0t
IGEvc291bmQvc29jL2NvZGVjcy93bTg5MDQuaAorKysgYi9zb3VuZC9zb2MvY29kZWNzL3dtODkw
NC5oCkBAIC0xMywxMSArMTMsNiBAQAogI2RlZmluZSBXTTg5MDRfQ0xLX01DTEsgMQogI2RlZmlu
ZSBXTTg5MDRfQ0xLX0ZMTCAgMgogCi0jZGVmaW5lIFdNODkwNF9GTExfTUNMSyAgICAgICAgICAx
Ci0jZGVmaW5lIFdNODkwNF9GTExfQkNMSyAgICAgICAgICAyCi0jZGVmaW5lIFdNODkwNF9GTExf
TFJDTEsgICAgICAgICAzCi0jZGVmaW5lIFdNODkwNF9GTExfRlJFRV9SVU5OSU5HICA0Ci0KIC8q
CiAgKiBSZWdpc3RlciB2YWx1ZXMuCiAgKi8KZGlmZiAtLWdpdCBhL3NvdW5kL3NvYy9jb2RlY3Mv
d21fZmxsLmMgYi9zb3VuZC9zb2MvY29kZWNzL3dtX2ZsbC5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
CmluZGV4IDAwMDAwMDAwMDAwMC4uYzc2NzE0ZTVmZWU1Ci0tLSAvZGV2L251bGwKKysrIGIvc291
bmQvc29jL2NvZGVjcy93bV9mbGwuYwpAQCAtMCwwICsxLDMzOSBAQAorLy8gU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogd21fZmxsLmMgIC0tICBXTTg5eHggRkxMIHN1
cHBvcnQKKyAqCisgKiBDb3B5cmlnaHQgMjAxOSBNaWNoYcWCIE1pcm9zxYJhdworICoKKyAqIFdN
ODkwNCBjYW4gZ2VuZXJhdGUgaXRzIGNsb2NrIGRpcmVjdGx5IGZyb20gTUNMSywgZnJvbQorICog
aW50ZXJuYWwgRkxMIHN5bmNocm9uaXppbmcgdG8gb25lIG9mIGh3IGZyYW1lIGNsb2NrcworICog
b3IgZnJvbSBGTEwncyBWQ08gaW4gZnJlZS1ydW5uaW5nIG1vZGUKKyAqLworCisjaW5jbHVkZSA8
bGludXgvYml0ZmllbGQuaD4KKyNpbmNsdWRlIDxsaW51eC9jbGstcHJvdmlkZXIuaD4KKyNpbmNs
dWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgorI2luY2x1ZGUg
IndtX2ZsbC5oIgorI2luY2x1ZGUgIndtODkwNC5oIgorCitlbnVtIHdtX2ZsbF9yZWZfc291cmNl
Cit7CisJRkxMX1JFRl9NQ0xLLAorCUZMTF9SRUZfQkNMSywKKwlGTExfUkVGX0ZTQ0xLLAorCUZM
TF9SRUZfT1NDLAorfTsKKworc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IHdtX2ZsbF9wYXJlbnRz
W10gPSB7CisJIm1jbGsiLCAiYmNsayIsICJscmNsayIsICJvc2MiCit9OworCitzdGF0aWMgYm9v
bCB3bV9mbGxfaW5fZnJlZV9ydW5uaW5nX21vZGUoc3RydWN0IHdtX2ZsbF9kYXRhICpodykKK3sK
Kwl1bnNpZ25lZCBpbnQgdmFsOworCisJaWYgKHJlZ21hcF9yZWFkKGh3LT5yZWdtYXAsIFdNODkw
NF9GTExfTkNPX1RFU1RfMCwgJnZhbCkgPCAwKQorCQlyZXR1cm4gZmFsc2U7CisKKwlyZXR1cm4g
RklFTERfR0VUKFdNODkwNF9GTExfRlJDX05DT19NQVNLLCB2YWwpOworfQorCitzdGF0aWMgaW50
IHdtX2ZsbF9nZXRfcGFyZW50KHN0cnVjdCB3bV9mbGxfZGF0YSAqaHcpCit7CisJdW5zaWduZWQg
aW50IHZhbDsKKwlpbnQgZXJyOworCisJLyogZnJlZS1ydW5uaW5nIG1vZGU/ICovCisJaWYgKHdt
X2ZsbF9pbl9mcmVlX3J1bm5pbmdfbW9kZShodykpCisJCXJldHVybiBGTExfUkVGX09TQzsKKwor
CWVyciA9IHJlZ21hcF9yZWFkKGh3LT5yZWdtYXAsIFdNODkwNF9GTExfQ09OVFJPTF81LCAmdmFs
KTsKKwlpZiAoZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKworCXJldHVybiBGSUVMRF9HRVQoV004
OTA0X0ZMTF9DTEtfUkVGX1NSQ19NQVNLLCB2YWwpOworfQorCitzdGF0aWMgaW50IHdtX2ZsbF9z
ZXRfcGFyZW50KHN0cnVjdCB3bV9mbGxfZGF0YSAqaHcsIGVudW0gd21fZmxsX3JlZl9zb3VyY2Ug
aW5kZXgpCit7CisJdW5zaWduZWQgdmFsOworCWJvb2wgb3NjX2VuID0gaW5kZXggPT0gRkxMX1JF
Rl9PU0M7CisJaW50IGVycjsKKworCWlmIChvc2NfZW4pIHsKKwkJLyogc2V0IG9zYyBmcmVxIChh
cHByb3ggOTZNSHopICovCisJCXZhbCA9IEZJRUxEX1BSRVAoV004OTA0X0ZMTF9GUkNfTkNPX1ZB
TF9NQVNLLCAweDE5KTsKKwkJZXJyID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGh3LT5yZWdtYXAsIFdN
ODkwNF9GTExfTkNPX1RFU1RfMSwKKwkJCQkJIFdNODkwNF9GTExfRlJDX05DT19WQUxfTUFTSywg
dmFsKTsKKwkJaWYgKGVyciA8IDApCisJCQlyZXR1cm4gZXJyOworCX0KKworCS8qIHNldCBmcmVl
LXJ1bm5pbmcgbW9kZSAqLworCXZhbCA9IEZJRUxEX1BSRVAoV004OTA0X0ZMTF9GUkNfTkNPX01B
U0ssIG9zY19lbik7CisJZXJyID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGh3LT5yZWdtYXAsIFdNODkw
NF9GTExfTkNPX1RFU1RfMCwKKwkJCQkgV004OTA0X0ZMTF9GUkNfTkNPX01BU0ssIHZhbCk7CisJ
aWYgKG9zY19lbiB8fCBlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJLyogc2V0IEZMTCByZWZl
cmVuY2UgaW5wdXQgKi8KKwl2YWwgPSBGSUVMRF9QUkVQKFdNODkwNF9GTExfQ0xLX1JFRl9TUkNf
TUFTSywgaW5kZXgpOworCWVyciA9IHJlZ21hcF91cGRhdGVfYml0cyhody0+cmVnbWFwLCBXTTg5
MDRfRkxMX0NPTlRST0xfNSwKKwkJCQkgV004OTA0X0ZMTF9DTEtfUkVGX1NSQ19NQVNLLCB2YWwp
OworCisJcmV0dXJuIGVycjsKK30KKworaW50IHdtX2ZsbF9lbmFibGUoc3RydWN0IHdtX2ZsbF9k
YXRhICpodykKK3sKKwl1bnNpZ25lZCBpbnQgdmFsOworCWludCBjbGtfc3JjOworCWludCBlcnIs
IHJldHJ5OworCisJY2xrX3NyYyA9IHdtX2ZsbF9nZXRfcGFyZW50KGh3KTsKKwlpZiAoY2xrX3Ny
YyA9PSBGTExfUkVGX01DTEspIHsKKwkJZXJyID0gY2xrX3ByZXBhcmVfZW5hYmxlKGh3LT5tY2xr
KTsKKwkJaWYgKGVyciA8IDApCisJCQlyZXR1cm4gZXJyOworCX0KKworCWVyciA9IHJlZ21hcF91
cGRhdGVfYml0cyhody0+cmVnbWFwLCBXTTg5MDRfRkxMX0NPTlRST0xfMSwKKwkJCQkgV004OTA0
X0ZMTF9PU0NfRU5BX01BU0ssIFdNODkwNF9GTExfT1NDX0VOQSk7CisJaWYgKGVyciA8IDApCisJ
CWdvdG8gZXJyX291dDsKKworCWVyciA9IHJlZ21hcF93cml0ZShody0+cmVnbWFwLCBXTTg5MDRf
SU5URVJSVVBUX1NUQVRVUywKKwkJCSAgIFdNODkwNF9GTExfTE9DS19FSU5UKTsKKwlpZiAoZXJy
IDwgMCkKKwkJZ290byBlcnJfb3V0OworCisJZXJyID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGh3LT5y
ZWdtYXAsIFdNODkwNF9GTExfQ09OVFJPTF8xLAorCQkJCSBXTTg5MDRfRkxMX0VOQV9NQVNLLCBX
TTg5MDRfRkxMX0VOQSk7CisJaWYgKGVycikKKwkJZ290byBlcnJfb3V0OworCisJaWYgKGNsa19z
cmMgPT0gRkxMX1JFRl9PU0MpIHsKKwkJdXNsZWVwX3JhbmdlKDE1MCwgMjUwKTsKKwkJcmV0dXJu
IDA7CisJfQorCisJZm9yIChyZXRyeSA9IDM7IHJldHJ5OyAtLXJldHJ5KSB7CisJCW1zbGVlcCgx
KTsKKwkJZXJyID0gcmVnbWFwX3JlYWQoaHctPnJlZ21hcCwgV004OTA0X0lOVEVSUlVQVF9TVEFU
VVMsICZ2YWwpOworCQlpZiAoZXJyIDwgMCkKKwkJCWdvdG8gZXJyX291dDsKKworCQlpZiAodmFs
ICYgV004OTA0X0ZMTF9MT0NLX0VJTlQpCisJCQlicmVhazsKKwl9CisKKwkvKiBpdCBzZWVtcyB0
aGF0IEZMTF9MT0NLIG1pZ2h0IG5ldmVyIGJlIGFzc2VydGVkICovCisJLyogZWcuIFdNODkwNCdz
IEZMTCBkb2Vzbid0LCBidXQgd29ya3MgYW55d2F5ICovCisJcmV0dXJuIDA7CisKK2Vycl9vdXQ6
CisJd21fZmxsX2Rpc2FibGUoaHcpOworCisJaWYgKGNsa19zcmMgPT0gRkxMX1JFRl9NQ0xLKQor
CQljbGtfZGlzYWJsZV91bnByZXBhcmUoaHctPm1jbGspOworCisJcmV0dXJuIGVycjsKK30KK0VY
UE9SVF9TWU1CT0xfR1BMKHdtX2ZsbF9lbmFibGUpOworCitpbnQgd21fZmxsX2Rpc2FibGUoc3Ry
dWN0IHdtX2ZsbF9kYXRhICpodykKK3sKKwlyZXR1cm4gcmVnbWFwX3VwZGF0ZV9iaXRzKGh3LT5y
ZWdtYXAsIFdNODkwNF9GTExfQ09OVFJPTF8xLAorCQkJCSAgV004OTA0X0ZMTF9FTkFfTUFTS3xX
TTg5MDRfRkxMX09TQ19FTkFfTUFTSywKKwkJCQkgIDApOworfQorRVhQT1JUX1NZTUJPTF9HUEwo
d21fZmxsX2Rpc2FibGUpOworCitzdGF0aWMgaW50IHdtX2ZsbF9pc19lbmFibGVkKHN0cnVjdCB3
bV9mbGxfZGF0YSAqaHcpCit7CisJdW5zaWduZWQgaW50IHZhbDsKKwlpbnQgZXJyOworCisJZXJy
ID0gcmVnbWFwX3JlYWQoaHctPnJlZ21hcCwgV004OTA0X0ZMTF9DT05UUk9MXzEsICZ2YWwpOwor
CWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJcmV0dXJuIEZJRUxEX0dFVChXTTg5MDRf
RkxMX0VOQV9NQVNLLCB2YWwpOworfQorCitzdGF0aWMgdW5zaWduZWQgaW50IHdtX2ZsbF9hcHBs
eV9yZWZkaXYodW5zaWduZWQgbG9uZyAqcGFyZW50X3JhdGUpCit7CisJdW5zaWduZWQgaW50IHJl
ZmRpdjsKKworCS8qIEZMTCBpbnB1dCBkaXZpZGVyOyBzaG91bGQgZW5zdXJlIEZpbiA8PSAxMy41
TUh6ICovCisKKwlyZWZkaXYgPSBESVZfUk9VTkRfVVAoKnBhcmVudF9yYXRlLCAxMzUwMDAwMCk7
CisJcmVmZGl2ID0gb3JkZXJfYmFzZV8yKHJlZmRpdik7CisJaWYgKHJlZmRpdiA+IDMpCisJCXJl
ZmRpdiA9IDM7CisKKwkqcGFyZW50X3JhdGUgPj49IHJlZmRpdjsKKworCXJldHVybiByZWZkaXY7
Cit9CisKK3N0YXRpYyB1bnNpZ25lZCBpbnQgd21fZmxsX2FwcGx5X2ZyYXRpbyh1bnNpZ25lZCBs
b25nICpwYXJlbnRfcmF0ZSkKK3sKKwl1bnNpZ25lZCBpbnQgZnJhdGlvOworCisJLyogRkxMIGNv
bXBhcmF0b3IgZGl2aWRlcjsgZWZlY3RpdmVseSBGaW4gbXVsdGlwbGllciAqLworCS8qIGFzIHRh
YnVsYXJpemVkIGluIFdNODkwNCBkYXRhc2hlZXQgKi8KKworCWlmICgqcGFyZW50X3JhdGUgPj0g
MjU2MDAwKQorCQlmcmF0aW8gPSAqcGFyZW50X3JhdGUgPCAxMDI0MDAwOworCWVsc2UgaWYgKCpw
YXJlbnRfcmF0ZSA+PSA2NDAwMCkKKwkJZnJhdGlvID0gMiArICgqcGFyZW50X3JhdGUgPCAxMjgw
MDApOworCWVsc2UKKwkJZnJhdGlvID0gNDsKKworCSpwYXJlbnRfcmF0ZSA8PD0gZnJhdGlvOwor
CisJcmV0dXJuIGZyYXRpbzsKK30KKworc3RhdGljIHVuc2lnbmVkIGludCB3bV9mbGxfYXBwbHlf
b3V0ZGl2X3Jldih1bnNpZ25lZCBsb25nICpyYXRlKQoreworCXVuc2lnbmVkIGludCBkaXY7CisK
KwkvKiBGdmNvIC0+IEZvdXQgZGl2aWRlcjsgdGFyZ2V0OiA5MCA8PSBGdmNvIDw9IDEwMCBNSHog
Ki8KKworCWRpdiA9IERJVl9ST1VORF9VUCg5MDAwMDAwMCwgKnJhdGUpOworCWlmIChkaXYgPiA2
NCkgeworCQkqcmF0ZSA9IDkwMDAwMDAwOworCQlyZXR1cm4gNjQ7CisJfQorCisJaWYgKGRpdiA8
IDQpCisJCWRpdiA9IDQ7CisKKwkqcmF0ZSAqPSBkaXY7CisJcmV0dXJuIGRpdjsKK30KKworaW50
IHdtX2ZsbF9zZXRfcmF0ZShzdHJ1Y3Qgd21fZmxsX2RhdGEgKmh3LCB1bnNpZ25lZCBsb25nIHJh
dGUpCit7CisJdW5zaWduZWQgbG9uZyBsb25nIGZyZXE7CisJdW5zaWduZWQgbG9uZyBtY2xrX3Jh
dGU7CisJdW5zaWduZWQgaW50IHZhbCwgbWFzaywgcmVmZGl2LCBvdXRkaXYsIGZyYXRpbzsKKwlp
bnQgZXJyLCBlbmFibGVkOworCisJZXJyID0gd21fZmxsX2dldF9wYXJlbnQoaHcpOworCWlmIChl
cnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJaWYgKGVyciAhPSBGTExfUkVGX09TQykgeworCQl1
bnNpZ25lZCBsb25nIHBhcmVudF9yYXRlID0gbWNsa19yYXRlID0gY2xrX2dldF9yYXRlKGh3LT5t
Y2xrKTsKKworCQlyZWZkaXYgPSB3bV9mbGxfYXBwbHlfcmVmZGl2KCZwYXJlbnRfcmF0ZSk7CisJ
CWZyYXRpbyA9IHdtX2ZsbF9hcHBseV9mcmF0aW8oJnBhcmVudF9yYXRlKTsKKwkJb3V0ZGl2ID0g
d21fZmxsX2FwcGx5X291dGRpdl9yZXYoJnJhdGUpOworCisJCWZyZXEgPSAodW5zaWduZWQgbG9u
ZyBsb25nKXJhdGUgPDwgMTY7CisJCWZyZXEgKz0gcGFyZW50X3JhdGUgLyAyOworCQlkb19kaXYo
ZnJlcSwgcGFyZW50X3JhdGUpOworCisJCXJhdGUgPSAoZnJlcSAqIHBhcmVudF9yYXRlKSA+PiAx
NjsKKwl9IGVsc2UgeworCQl1bnNpZ25lZCBsb25nIHZjb19yYXRlID0gOTYwMDAwMDA7CisKKwkJ
bWNsa19yYXRlID0gMDsKKwkJZnJhdGlvID0gcmVmZGl2ID0gMDsKKwkJcmF0ZSA9IERJVl9ST1VO
RF9DTE9TRVNUKHZjb19yYXRlLCByYXRlKTsKKwkJb3V0ZGl2ID0gY2xhbXBfdCh1bnNpZ25lZCBs
b25nLCByYXRlLCA0LCA2NCk7CisJCWZyZXEgPSAweDE3NyA8PCAxNjsKKworCQlyYXRlID0gdmNv
X3JhdGU7CisJfQorCisJLyogY29uZmlndXJlICovCisKKwllbmFibGVkID0gZXJyID0gd21fZmxs
X2lzX2VuYWJsZWQoaHcpOworCWlmIChlcnIgPiAwKQorCQllcnIgPSB3bV9mbGxfZGlzYWJsZSho
dyk7CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwlkZXZfZGJnKHJlZ21hcF9nZXRf
ZGV2aWNlKGh3LT5yZWdtYXApLAorCQkiY29uZmlndXJpbmcgRkxMIGZvciAlbHVIeiAtPiAlbHVI
eiAtPiAlbHVIeiVzXG4iLAorCQltY2xrX3JhdGUsIHJhdGUsIHJhdGUgLyBvdXRkaXYsCisJCWVu
YWJsZWQgPyAiICh3aGlsZSBlbmFibGVkKSIgOiAiIik7CisJZGV2X2RiZyhyZWdtYXBfZ2V0X2Rl
dmljZShody0+cmVnbWFwKSwKKwkJIkZMTCBzZXR0aW5nczogTj0lbGx1IEs9JWxsdSBGUkFUSU89
JXUgT1VURElWPSV1IFJFRl9ESVY9JXVcbiIsCisJCWZyZXEgPj4gMTYsIGZyZXEgJiAweEZGRkYs
IGZyYXRpbywgb3V0ZGl2LCByZWZkaXYpOworCisJdmFsID0gRklFTERfUFJFUChXTTg5MDRfRkxM
X0NMS19SRUZfRElWX01BU0ssIHJlZmRpdik7CisJZXJyID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGh3
LT5yZWdtYXAsIFdNODkwNF9GTExfQ09OVFJPTF81LAorCQkJCSBXTTg5MDRfRkxMX0NMS19SRUZf
RElWX01BU0ssIHZhbCk7CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwl2YWwgPSBG
SUVMRF9QUkVQKFdNODkwNF9GTExfT1VURElWX01BU0ssIG91dGRpdiAtIDEpIHwKKwkgICAgICBG
SUVMRF9QUkVQKFdNODkwNF9GTExfRlJBVElPX01BU0ssIGZyYXRpbyk7CisJbWFzayA9IFdNODkw
NF9GTExfT1VURElWX01BU0sgfCBXTTg5MDRfRkxMX0ZSQVRJT19NQVNLOworCWVyciA9IHJlZ21h
cF91cGRhdGVfYml0cyhody0+cmVnbWFwLCBXTTg5MDRfRkxMX0NPTlRST0xfMiwgbWFzaywgdmFs
KTsKKwlpZiAoZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKworCWVyciA9IHJlZ21hcF93cml0ZSho
dy0+cmVnbWFwLCBXTTg5MDRfRkxMX0NPTlRST0xfMywgKHVpbnQxNl90KWZyZXEpOworCWlmIChl
cnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJdmFsID0gRklFTERfUFJFUChXTTg5MDRfRkxMX0ZS
QUNOX0VOQV9NQVNLLCAhISh1aW50MTZfdClmcmVxKTsKKwllcnIgPSByZWdtYXBfdXBkYXRlX2Jp
dHMoaHctPnJlZ21hcCwgV004OTA0X0ZMTF9DT05UUk9MXzEsCisJCQkJIFdNODkwNF9GTExfRlJB
Q05fRU5BX01BU0ssIHZhbCk7CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwl2YWwg
PSBGSUVMRF9QUkVQKFdNODkwNF9GTExfTl9NQVNLLCBmcmVxID4+IDE2KTsKKwllcnIgPSByZWdt
YXBfdXBkYXRlX2JpdHMoaHctPnJlZ21hcCwgV004OTA0X0ZMTF9DT05UUk9MXzQsCisJCQkJIFdN
ODkwNF9GTExfTl9NQVNLLCB2YWwpOworCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJ
aWYgKGVuYWJsZWQpCisJCWVyciA9IHdtX2ZsbF9lbmFibGUoaHcpOworCisJcmV0dXJuIGVycjsK
K30KK0VYUE9SVF9TWU1CT0xfR1BMKHdtX2ZsbF9zZXRfcmF0ZSk7CisKK2ludCB3bV9mbGxfaW5p
dChzdHJ1Y3Qgd21fZmxsX2RhdGEgKmh3LCBzdHJ1Y3QgZGV2aWNlICpkZXYpCit7CisJY29uc3Qg
Y2hhciAqc3JjOworCWludCBlcnIsIGluZGV4OworCisJZXJyID0gb2ZfcHJvcGVydHlfcmVhZF9z
dHJpbmcoZGV2LT5vZl9ub2RlLCAid2xmLGZsbC1pbnB1dCIsICZzcmMpOworCWlmIChlcnIgPT0g
LUVJTlZBTCkKKwkJaW5kZXggPSBlcnIgPSAwOworCWVsc2UgaWYgKGVyciA+PSAwKQorCQlpbmRl
eCA9IGVyciA9IG1hdGNoX3N0cmluZyh3bV9mbGxfcGFyZW50cywKKwkJCQkJICAgQVJSQVlfU0la
RSh3bV9mbGxfcGFyZW50cyksIHNyYyk7CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisK
Kwlody0+bWNsayA9IE5VTEw7CisJaWYgKCFpbmRleCkgeworCQlody0+bWNsayA9IGRldm1fY2xr
X2dldChkZXYsICJtY2xrIik7CisJCWlmIChJU19FUlIoaHctPm1jbGspKSB7CisJCQllcnIgPSBQ
VFJfRVJSKGh3LT5tY2xrKTsKKwkJCWRldl9lcnIoZGV2LCAiRmFpbGVkIHRvIGdldCBNQ0xLIGZv
ciBGTEw6ICVkXG4iLCBlcnIpOworCQkJcmV0dXJuIGVycjsKKwkJfQorCX0KKworCWh3LT5yZWdt
YXAgPSBkZXZfZ2V0X3JlZ21hcChkZXYsIE5VTEwpOworCWlmICghaHctPnJlZ21hcCkgeworCQlk
ZXZfZXJyKGRldiwgImRyaXZlciBCVUc6IHJlZ21hcCBub3QgY29uZmlndXJlZFxuIik7CisJCXJl
dHVybiAtRUlOVkFMOworCX0KKworCWVyciA9IHdtX2ZsbF9zZXRfcGFyZW50KGh3LCBpbmRleCk7
CisKKwlyZXR1cm4gZXJyOworfQorRVhQT1JUX1NZTUJPTF9HUEwod21fZmxsX2luaXQpOwpkaWZm
IC0tZ2l0IGEvc291bmQvc29jL2NvZGVjcy93bV9mbGwuaCBiL3NvdW5kL3NvYy9jb2RlY3Mvd21f
ZmxsLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4yNTE4YTA5MTAx
NzkKLS0tIC9kZXYvbnVsbAorKysgYi9zb3VuZC9zb2MvY29kZWNzL3dtX2ZsbC5oCkBAIC0wLDAg
KzEsMjYgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKworLyoKKyAqIHdt
X2ZsbC5oICAtLSAgRkxMIHN1cHBvcnQgZm9yIFdvbGZzb24gY29kZWNzCisgKgorICogQ29weXJp
Z2h0IDIwMTkgTWljaGHFgiBNaXJvc8WCYXcKKyAqLworCisjaWZuZGVmIF9XTV9GTExfSAorI2Rl
ZmluZSBfV01fRkxMX0gKKworI2luY2x1ZGUgPGxpbnV4L2Nsay5oPgorI2luY2x1ZGUgPGxpbnV4
L2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgorCitzdHJ1Y3Qgd21fZmxsX2Rh
dGEKK3sKKwlzdHJ1Y3QgcmVnbWFwCQkJKnJlZ21hcDsKKwlzdHJ1Y3QgY2xrCQkJKm1jbGs7Cit9
OworCitpbnQgd21fZmxsX2luaXQoc3RydWN0IHdtX2ZsbF9kYXRhICpodywgc3RydWN0IGRldmlj
ZSAqZGV2KTsKK2ludCB3bV9mbGxfZW5hYmxlKHN0cnVjdCB3bV9mbGxfZGF0YSAqaHcpOworaW50
IHdtX2ZsbF9kaXNhYmxlKHN0cnVjdCB3bV9mbGxfZGF0YSAqaHcpOworaW50IHdtX2ZsbF9zZXRf
cmF0ZShzdHJ1Y3Qgd21fZmxsX2RhdGEgKmh3LCB1bnNpZ25lZCBsb25nIHJhdGUpOworCisjZW5k
aWYgLyogX1dNX0ZMTF9IICovCi0tIAoyLjIwLjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fCkFsc2EtZGV2ZWwgbWFpbGluZyBsaXN0CkFsc2EtZGV2ZWxA
YWxzYS1wcm9qZWN0Lm9yZwpodHRwczovL21haWxtYW4uYWxzYS1wcm9qZWN0Lm9yZy9tYWlsbWFu
L2xpc3RpbmZvL2Fsc2EtZGV2ZWwK
