Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 4A3EB2D7685
	for <lists+alsa-devel@lfdr.de>; Fri, 11 Dec 2020 14:29:12 +0100 (CET)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id E76D31761;
	Fri, 11 Dec 2020 14:28:21 +0100 (CET)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz E76D31761
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1607693352;
	bh=w/bzGzcG1EUJzllaOhECNYCAqB7jd6zs2WcSzyQ+v6M=;
	h=Date:From:To:Subject:In-Reply-To:References:Cc:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=AVE57khbo5ldPqQOQp47HTXHMn4Kd5oxTXp3S9pyF4SmxsyaQEWa5Gmi8O+vH2OH9
	 lVCW2GQqfxpujWAzdjlaTmQ2f7bNtKJWrMnfQMF1L1us2r6hNwA8pvrfThFp9435AG
	 tURvjpHb32bkdSENKUGMUs2SLOSW9RhH10bCUP7E=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id A0196F80217;
	Fri, 11 Dec 2020 14:27:36 +0100 (CET)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id CE12FF8020D; Fri, 11 Dec 2020 14:27:34 +0100 (CET)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=SPF_HELO_NONE,SPF_NONE,
 URIBL_BLOCKED autolearn=disabled version=3.4.0
Received: from mx2.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id D0D6FF80105
 for <alsa-devel@alsa-project.org>; Fri, 11 Dec 2020 14:27:26 +0100 (CET)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz D0D6FF80105
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.221.27])
 by mx2.suse.de (Postfix) with ESMTP id 9C0F6AC10;
 Fri, 11 Dec 2020 13:27:25 +0000 (UTC)
Date: Fri, 11 Dec 2020 14:27:25 +0100
Message-ID: <s5hy2i4o4le.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Kai Vehmanen <kai.vehmanen@linux.intel.com>
Subject: Re: [PATCH] ALSA: hda/hdmi: packet buffer index must be set before
 reading value
In-Reply-To: <20201211131613.3271407-1-kai.vehmanen@linux.intel.com>
References: <20201211131613.3271407-1-kai.vehmanen@linux.intel.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Cc: alsa-devel@alsa-project.org
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Fri, 11 Dec 2020 14:16:13 +0100,
Kai Vehmanen wrote:
> 
> The check for infoframe transmit status in hdmi_infoframe_uptodate()
> makes the assumption that packet buffer index is set to zero.
> 
> Align code with specification and explicitly set the index before
> AC_VERB_GET_HDMI_DIP_XMIT. The packet index setting affects both
> DIP-Data and DIP-XmitCtrl verbs.
> 
> There are no known cases where the old implementation has caused driver
> to work incorrectly. This change is purely based on code review against
> the specification (HDA spec rev1.0a).
> 
> Signed-off-by: Kai Vehmanen <kai.vehmanen@linux.intel.com>

Currently there is no other place to change DIP index, i.e. it's
always zero, and the bug wouldn't hit, but it's better to be addressed
beforehand, indeed.

Applied now.  Thanks.


Takashi
