Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 86C5E6E7A5
	for <lists+alsa-devel@lfdr.de>; Fri, 19 Jul 2019 17:03:55 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id DD1C416AC;
	Fri, 19 Jul 2019 17:03:04 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz DD1C416AC
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1563548635;
	bh=f+mLvcvs2qbXJq7JrrB03rMeCSQ8bXfliCLfUSvA6QQ=;
	h=Date:From:To:In-Reply-To:References:Cc:Subject:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=EA3aAZ1Wh5cw0rISQGGH42Mk6vvKF//zn9bkGbr0zFv+L99UgYo+61JCr5TEDffrH
	 6VlN3Poj5lZKqwg3CiuelQE9/NxkZuvm4+1q4beNCK68ykJ6almljt6/NHsmoIfe4A
	 8Qk7hZPBXRyEEo6YObUHpTE3vekL0PkUEb6Q0d9c=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 1CF9BF80228;
	Fri, 19 Jul 2019 17:02:11 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id DDF0FF80272; Fri, 19 Jul 2019 17:02:07 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.5 required=5.0 tests=PRX_BODY_14,SPF_HELO_NONE,
 SPF_PASS autolearn=disabled version=3.4.0
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id 9B872F8015B
 for <alsa-devel@alsa-project.org>; Fri, 19 Jul 2019 17:02:04 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 9B872F8015B
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 4EEE3ADF7;
 Fri, 19 Jul 2019 15:02:03 +0000 (UTC)
Date: Fri, 19 Jul 2019 17:02:03 +0200
Message-ID: <s5hwoge9ifo.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Andy Davison <andy@dvsn.net>
In-Reply-To: <CAPk8ziH=P8ST6Ao54NycgiZePDr=T0+L6uVxA=c+pvhjZZCbPA@mail.gmail.com>
References: <CAPk8ziH=P8ST6Ao54NycgiZePDr=T0+L6uVxA=c+pvhjZZCbPA@mail.gmail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Cc: alsa-devel@alsa-project.org
Subject: Re: [alsa-devel] Patch Update for OpenFrame Sigmatel STAC9202
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Wed, 19 Jun 2019 14:25:37 +0200,
Andy Davison wrote:
> 
> Hi all,
> 
> Would anybody on this list have a little time to investigate this patch and
> bring it up to date for application against the latest 5.1 kernel, or
> indeed anything being actively developed?
> 
> https://gist.github.com/andydvsn/c0c159f99bf19d5b30b5e5e156dcac3e
> 
> This applies correctly against the 2.6.33 kernel, but I I lack the
> necessary ALSA knowledge and programming skills to make the appropriate
> corrections for anything more recent.
> 
> Alternatively, any other advice on where I could seek help with this would
> be much appreciated. It is the only outstanding kernel issue for this
> device and would love to have it fixed.

Oh well, that's a patch against the pretty old code base...

First of all, you need to identify which changes are missing.
Basically your patch does:
- The pin configuration override (openpeak9202_pin_configs[])
- GPIO pin #0 (needs clear?)

Both could be done even without patching the kernel.  I'd start just
setting up the pin configs and adjust GPIO manually via hda-verb to
see what actually it does.

A tricky part is the strange code that is peeking the 0xffbc0100
address.  I don't know exactly what it detects, but some pin configs
are changed according to the value read there.  This can't be
implemented in the upstream code in that way, but we may provide two
different models so that user can simply choose, for example.


Takashi
_______________________________________________
Alsa-devel mailing list
Alsa-devel@alsa-project.org
https://mailman.alsa-project.org/mailman/listinfo/alsa-devel
