Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 9D4E254D42
	for <lists+alsa-devel@lfdr.de>; Tue, 25 Jun 2019 13:07:32 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 11EDD9F6;
	Tue, 25 Jun 2019 13:06:42 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 11EDD9F6
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1561460852;
	bh=Pnjo5SK9y1BDjSDV8gAp/02ltPS7FFNoHbcwgcjQDes=;
	h=Date:From:To:In-Reply-To:References:Cc:Subject:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=m4ep+BOxBdBhzxMMy0tig2blOSI4uqy9ZIyPBIXewaR1tqRZB+6cG08u/leWEI03q
	 sv9L3PVSJFG1AlvF2M8aavhsNUDn2CDWBxajwWWXQ5CmYvjFpIB7O9n9b6zkUebKMf
	 KK7DFxlBdRvPOaCs3W3T9lQxIM0R6X/aXgcgjv6c=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 63200F896F0;
	Tue, 25 Jun 2019 13:05:47 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id 2666EF896F9; Tue, 25 Jun 2019 13:05:45 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=SPF_HELO_NONE,SPF_PASS
 autolearn=disabled version=3.4.0
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id 4AE20F896EA
 for <alsa-devel@alsa-project.org>; Tue, 25 Jun 2019 13:05:41 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 4AE20F896EA
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 21C19AF22;
 Tue, 25 Jun 2019 11:05:41 +0000 (UTC)
Date: Tue, 25 Jun 2019 13:05:40 +0200
Message-ID: <s5hpnn1x6uz.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: "Yang, Libin" <libin.yang@intel.com>
In-Reply-To: <96A12704CE18D347B625EE2D4A099D19528A2E44@SHSMSX103.ccr.corp.intel.com>
References: <1558948047-18930-1-git-send-email-libin.yang@intel.com>
 <1558948047-18930-4-git-send-email-libin.yang@intel.com>
 <s5hftowv2ii.wl-tiwai@suse.de>
 <96A12704CE18D347B625EE2D4A099D195285809B@SHSMSX103.ccr.corp.intel.com>
 <s5hsgswt1at.wl-tiwai@suse.de>
 <96A12704CE18D347B625EE2D4A099D19528582FD@SHSMSX103.ccr.corp.intel.com>
 <96A12704CE18D347B625EE2D4A099D195289BC7B@SHSMSX103.ccr.corp.intel.com>
 <96A12704CE18D347B625EE2D4A099D19528A2E44@SHSMSX103.ccr.corp.intel.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Cc: 'Hui Wang' <hui.wang@canonical.com>,
 "'alsa-devel@alsa-project.org'" <alsa-devel@alsa-project.org>,
 "'broonie@kernel.org'" <broonie@kernel.org>,
 "'pierre-louis.bossart@linux.intel.com'"
 <pierre-louis.bossart@linux.intel.com>
Subject: Re: [alsa-devel] [RFC PATCH 3/4] ASoC: hdac_hdmi: refine hdmi jacks
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Tue, 25 Jun 2019 08:02:45 +0200,
Yang, Libin wrote:
> 
> >
> >Sorry for a long delay for the hdmi jacks. I was busy on another critical issue
> >last 2 weeks. I have worked out the UCM configuration files. Please check the
> >attachment. It is a long file, so I use the attachment instead of the patch mode.
> >Based on my test, it works well. Could you please help review if the
> >configuration file is OK or not. I will do more test on the meantime, including
> >DPMST and NON-DPMST.
> 
> With some more tests on the new hdmi jack with UCM configuration, I found
> that the kernel patch can always notify the jack hotplug event to userspace
> correctly. However, the userspace can't set the amixer correctly based on
> the UCM configurations sometimes.
> 
> Here is the details:
> There are 3 PCMs on Intel platforms. Let's call them pcm1, pcm2, pcm3.
> And there are 3 pins (pin5, pin6, pin7). For DPMST, and each pin has 3 ports:
> port0, port1, port2.
> 
> For non-DPMST, we can set pin5 <=> pcm1, pin6 <=> pcm2, pin7 <=> pcm3.
> This can always work.
> 
> For DPMST, as there are 9 ports using 3 pcms. So we should assign
> 1 pcm to 3 ports. For example, pin5-port0, pin6-port1 and pin7-port2
> are using pcm1;  pin5-port1, pin6-port2 and pin7-port0 are using
> pcm2; pin5-port2; pin6-port3 and pin7-port1 are using pcm3.
> In this setting, we should setting the ConflictingDevice in UCM.
> For example, pin5-port0 is conflicting with pin6-port1 and pin7-port2.
> Hui and I found if we set one device conflicting with 2 devices, the
> amixer setting will be wrong and it will not following UCM configuration
> setting when we are hotplugging the monitors.

How wrong would it behave?  Only one of them is done?

> Hui and I thought this may be the alsa-lib or pulseaudio issue.

You can try alsaucm directly without PA, too.
But in general the conflicting device management is done in PA, so I'd
begin with tracking the PA UCM code at first.


thanks,

Takashi
_______________________________________________
Alsa-devel mailing list
Alsa-devel@alsa-project.org
https://mailman.alsa-project.org/mailman/listinfo/alsa-devel
