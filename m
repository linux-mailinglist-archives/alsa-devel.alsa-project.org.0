Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 5381A65205B
	for <lists+alsa-devel@lfdr.de>; Tue, 20 Dec 2022 13:28:39 +0100 (CET)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher ADH-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id D03B3191B;
	Tue, 20 Dec 2022 13:27:48 +0100 (CET)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz D03B3191B
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1671539318;
	bh=Purg9PIqW/1TBnJPmqleblmh1TFbbntxvDA7ihUcQPI=;
	h=Date:From:To:Subject:In-Reply-To:References:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 Cc:From;
	b=mMjYG/kfqFK0z6X4GVYu5Y8EujJ56fiSQpcyyzP3QZph1TKPQroUo2UyaNbcM96uo
	 5c674uC6VYFzwckzUR3txJiFHLcTD4Yp8Jxl948k6B63kbzoBWNedoEEWr/eAjLOP2
	 MGmg6Jqqt21+l1U5tv3EADYItizTKVJo2XKKVUZg=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 7A8C6F8032B;
	Tue, 20 Dec 2022 13:27:41 +0100 (CET)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id 9B697F8025E; Tue, 20 Dec 2022 13:27:39 +0100 (CET)
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=-5.2 required=5.0 tests=DKIM_SIGNED,DKIM_VALID,
 DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_HI,SPF_HELO_NONE,SPF_PASS,
 URIBL_BLOCKED shortcircuit=no autolearn=ham autolearn_force=no
 version=3.4.6
Received: from smtp-out2.suse.de (smtp-out2.suse.de [195.135.220.29])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature RSA-PSS (4096 bits) server-digest SHA256)
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id E514AF8018A
 for <alsa-devel@alsa-project.org>; Tue, 20 Dec 2022 13:27:37 +0100 (CET)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz E514AF8018A
Authentication-Results: alsa1.perex.cz;
 dkim=pass (1024-bit key, unprotected) header.d=suse.de header.i=@suse.de
 header.a=rsa-sha256 header.s=susede2_rsa header.b=Czvvq32z; 
 dkim=pass header.d=suse.de header.i=@suse.de header.a=ed25519-sha256
 header.s=susede2_ed25519 header.b=gDsrSuvP
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
 (No client certificate requested)
 by smtp-out2.suse.de (Postfix) with ESMTPS id 2C95E75C14;
 Tue, 20 Dec 2022 12:27:37 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
 t=1671539257; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
 mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=oppyfO3kjNX4WPlQpDPLe2f/6tYwV/K4TERCCx1nk0Q=;
 b=Czvvq32zphllbpZQLRlmeu+YqQcu0QFYDITaUa0KLf3SDqzET/dYV78ZjNT4+6syQtNYqc
 Mt9hfXjsKD+CJeZ+TEmZlunopL2EjXike1UtrqaC3gVnAUDFmLme3vehe0a/jXvVn+zAKN
 bNhMwGnQVxapA6hJ0wKpFh4dUtNFy4Q=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
 s=susede2_ed25519; t=1671539257;
 h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
 mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=oppyfO3kjNX4WPlQpDPLe2f/6tYwV/K4TERCCx1nk0Q=;
 b=gDsrSuvPuc3ONuBsjwKpB2O/+6mIGbDGHixHiR+fWGonKVHyGOrip8anMuKGFvX4OcmMDE
 ur+Ysi2cinSJwKDw==
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
 (No client certificate requested)
 by imap2.suse-dmz.suse.de (Postfix) with ESMTPS id 1B87913254;
 Tue, 20 Dec 2022 12:27:37 +0000 (UTC)
Received: from dovecot-director2.suse.de ([192.168.254.65])
 by imap2.suse-dmz.suse.de with ESMTPSA id d9pmBjmqoWNMcgAAMHmgww
 (envelope-from <tiwai@suse.de>); Tue, 20 Dec 2022 12:27:37 +0000
Date: Tue, 20 Dec 2022 13:27:36 +0100
Message-ID: <s5hk02mp8ef.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Christoph Hellwig <hch@lst.de>
Subject: Re: fix GFP_COMP use in noncoherent dma allocators
In-Reply-To: <20221220082009.569785-1-hch@lst.de>
References: <20221220082009.569785-1-hch@lst.de>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) Emacs/27.2 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Cc: alsa-devel@alsa-project.org, Takashi Iwai <tiwai@suse.com>,
 iommu@lists.linux.dev, Robin Murphy <robin.murphy@arm.com>,
 Marek Szyprowski <m.szyprowski@samsung.com>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Tue, 20 Dec 2022 09:20:07 +0100,
Christoph Hellwig wrote:
> 
> Hi all,
> 
> this series fixe the regression where dma-iommu stopped clearing
> GFP_COMP from noncoherent dma allocations by never requesting those
> in the sound code and rejecting them in the core DMA API code.
> 
> Diffstat:
>  kernel/dma/mapping.c  |    4 ++++
>  sound/core/memalloc.c |    4 ++--
>  2 files changed, 6 insertions(+), 2 deletions(-)

Thank you Christoph for taking care of this mess, and apologies for my
delayed reaction, as I've been (still) on vacation since the last
week.

FWIW, feel free to take my ack for the sound part:

Acked-by: Takashi Iwai <tiwai@suse.de>


Takashi
