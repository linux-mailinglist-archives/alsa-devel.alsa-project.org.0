Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id D3E3A5EC59F
	for <lists+alsa-devel@lfdr.de>; Tue, 27 Sep 2022 16:12:32 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 5474A82C;
	Tue, 27 Sep 2022 16:11:42 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 5474A82C
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1664287952;
	bh=QA2fGJ+oY4xpQjlh1fKLfiwAvuRz8yeyghZy6iuegAI=;
	h=Date:From:To:Subject:In-Reply-To:References:Cc:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=DA57f01nKf7sjaXQ0zr2Ih0Q6X98yGt1XLfzfPyOXoW/4tOVV/nt/O0kcmcJIEMQi
	 7/TeeJUosSf0gaEQDjBK7g1f1299HgfS7JX4WXVdXGSDPpSY+oI1m++1XEbJN7dPzy
	 Y8Qhg+jJ+5u5OYhoisDVBRWK9SYcyEJYqK5F/3XM=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id A986FF80166;
	Tue, 27 Sep 2022 16:11:35 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id D0479F8025E; Tue, 27 Sep 2022 16:11:34 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=-0.1 required=5.0 tests=DKIM_SIGNED,DKIM_VALID,
 DKIM_VALID_AU,SPF_HELO_NONE,SPF_NONE,T_SCC_BODY_TEXT_LINE,URIBL_BLOCKED
 autolearn=disabled version=3.4.0
Received: from smtp-out1.suse.de (smtp-out1.suse.de [195.135.220.28])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id BE635F80166
 for <alsa-devel@alsa-project.org>; Tue, 27 Sep 2022 16:11:28 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz BE635F80166
Authentication-Results: alsa1.perex.cz;
 dkim=pass (1024-bit key) header.d=suse.de header.i=@suse.de
 header.b="OEXGCLQV"; 
 dkim=permerror (0-bit key) header.d=suse.de header.i=@suse.de
 header.b="xFJenLK0"
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
 (No client certificate requested)
 by smtp-out1.suse.de (Postfix) with ESMTPS id 3658B21EA3;
 Tue, 27 Sep 2022 14:11:28 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
 t=1664287888; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
 mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=4Gs2kEEXPWw8vO1C2gEMXnJnBJTxf0UA1/lUrHbqkNA=;
 b=OEXGCLQVDDhZ90tqpTdhiNeEUI4kIbcjSBjKa4C3iw5ydwWyZIglT3szRei6kYK7Ij1THB
 iZ33ZLzckAI1TDAm1lyPnkmCVMIjvVJJ2B5oNhBFTsu/rKg6drPlU/WM9v9+W9LebpnnsU
 9P9i+Fb4y4C766XjrY9tTT0ao380bzk=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
 s=susede2_ed25519; t=1664287888;
 h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
 mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=4Gs2kEEXPWw8vO1C2gEMXnJnBJTxf0UA1/lUrHbqkNA=;
 b=xFJenLK09yl5B9GuvcYmJ2U0WILvMRMEomoZ8vKm02QGZl3ggYvDrwJ4lQ5wCHukhakIm7
 8UD/VTnf4hvYL9CA==
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
 (No client certificate requested)
 by imap2.suse-dmz.suse.de (Postfix) with ESMTPS id DF666139B3;
 Tue, 27 Sep 2022 14:11:27 +0000 (UTC)
Received: from dovecot-director2.suse.de ([192.168.254.65])
 by imap2.suse-dmz.suse.de with ESMTPSA id ZsLQNY8EM2OSOQAAMHmgww
 (envelope-from <tiwai@suse.de>); Tue, 27 Sep 2022 14:11:27 +0000
Date: Tue, 27 Sep 2022 16:11:27 +0200
Message-ID: <87ill8gb5c.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Brent Lu <brent.lu@intel.com>
Subject: Re: [PATCH] ALSA: hda/hdmi: run eld notify in delay work
In-Reply-To: <20220927135807.4097052-1-brent.lu@intel.com>
References: <20220927135807.4097052-1-brent.lu@intel.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) Emacs/27.2 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
Cc: alsa-devel@alsa-project.org, Kai Vehmanen <kai.vehmanen@linux.intel.com>,
 linux-kernel@vger.kernel.org,
 Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>,
 Takashi Iwai <tiwai@suse.com>, Mohan Kumar <mkumard@nvidia.com>,
 Ville =?ISO-8859-1?Q?Syrj=E4l=E4?= <ville.syrjala@linux.intel.com>,
 Yong Zhi <yong.zhi@intel.com>
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Tue, 27 Sep 2022 15:58:07 +0200,
Brent Lu wrote:
> 
> During resolution change, display driver would disable HDMI audio then
> enable it in a short time. There is possibility that eld notify for
> HDMI audio enable is called when previous runtime suspend is still
> running. In this case, the elf nofity just returns and not updating the
> status of corresponding HDMI pin/port. Here we move the eld nofity to
> a delay work so we don't lose it.
> 
> Signed-off-by: Brent Lu <brent.lu@intel.com>

We have already a dedicated per-pin work for the delayed ELD check.
Can we reuse it instead of inventing yet another work?
More work needs more cares, and better to avoid unless really needed
(e.g. you forgot cleanup at suspend/removal in this patch).


thanks,

Takashi
