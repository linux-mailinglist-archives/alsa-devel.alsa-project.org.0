Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id C57152057E8
	for <lists+alsa-devel@lfdr.de>; Tue, 23 Jun 2020 18:51:53 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 5218917B0;
	Tue, 23 Jun 2020 18:51:03 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 5218917B0
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1592931113;
	bh=mp2veAmJrx0HjmM7bfHyrU2dCOosKZKwlfPv3nLAWSc=;
	h=Date:From:To:Subject:In-Reply-To:References:Cc:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=LlhOgwsEZ8QzveQwblKhzVfNDfWE/3uiBYRLrG77+ykblFsor1G21JDTVgyGeui4i
	 qvZlS4UtnuQPDZYPtGaIwMvQ9kdBc9kT0ouzXnsdxV/QBROjYz0FMGfe/+3wjH6nnP
	 Tz3F+ioPnHkSaoa44pEMjOt9/Zpe/blTLd+TsCdw=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 6A365F80218;
	Tue, 23 Jun 2020 18:50:12 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id 3D451F80234; Tue, 23 Jun 2020 18:50:09 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=RCVD_IN_MSPIKE_H3,
 RCVD_IN_MSPIKE_WL,SPF_HELO_NONE,SPF_PASS,URIBL_BLOCKED autolearn=disabled
 version=3.4.0
Received: from mx2.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id 2C563F8012F
 for <alsa-devel@alsa-project.org>; Tue, 23 Jun 2020 18:49:59 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 2C563F8012F
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.221.27])
 by mx2.suse.de (Postfix) with ESMTP id 04304AEAF;
 Tue, 23 Jun 2020 16:49:59 +0000 (UTC)
Date: Tue, 23 Jun 2020 18:49:59 +0200
Message-ID: <s5h366ln2vc.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Stanislav Kazmin <stas.kazmin@gmail.com>
Subject: Re: [HDAudio][ALC295] speakers not working on Acer Travelmate P614
In-Reply-To: <CA+-1zuv3SeumhdMbqXjZU0tbmh7HB9LwTK2bfNTe5nOCmz4BgA@mail.gmail.com>
References: <CA+-1zuv3SeumhdMbqXjZU0tbmh7HB9LwTK2bfNTe5nOCmz4BgA@mail.gmail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Cc: alsa-devel@alsa-project.org
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Tue, 23 Jun 2020 17:49:18 +0200,
Stanislav Kazmin wrote:
> 
> Hello, I have the following problem on my Acer TravelMate P614-51T-G2:
> 
> I have all the audio sinks correctly identified (like HDMI, DMic, Headphones)
> but the internal speakers do not produce any sound.
> 
> What I have tried so far:
> 
> - hard/soft shutdown on Windows and reboot
> - disable/re-enable speakers and microphone in BIOS
> - uninstall pulseaudio and test alsa alone (so it is defeitely **not** a
> pulseaudio issue)
> - switch from sof-hda-dsp to snd-hda-intel driver (without Dmic support)
> - retask pins 0x14, 0x16, 0x1b to "Internal Speakers" through hdajackretask
> (only basic, without advanced features)
> - removed/reconnected the headphones
> 
> `alsamixer` shows all needed sinks and nothing is muted.
> 
> I already discussed the issue at sof github https://github.com/thesofproject/
> sof/issues/3058 but since the same issue occurs on `snd-hda-intel` legacy
> river, I was advised to communicate with alsa-devel team.
> 
> The alsa-info.sh result are linked at http://alsa-project.org/db/?
> f=252f92c7a1df3c755d16ee69353b26d2535a4d81
> 
> I have tested the kernel 5.8-rc1 but it does not make any difference.
> 
> Let me know if I can do anything else to test the issue.

It's hard to know and the only way is to some trial-and-errors.
The first shot I'd take is to toggle GPIO pins.  You can change the
bit via hda-verb program like
  hda-verb /dev/snd/hwC0D0 0x01 SET_GPIO_DIR 0x01
  hda-verb /dev/snd/hwC0D0 0x01 SET_GPIO_MASK 0x01
  hda-verb /dev/snd/hwC0D0 0x01 SET_GPIO_DATA 0x01
  
to turn on the bit 0 of GPIO.  The first 0x01 is the node ID and it's
0x01 on Realtek, and the last 0x01 the GPIO bit 0.  For toggling the
bit 1, pass 0x02 in the last argument, and for bit 2, pass 0x04.

And try turn on EAPD on non-used pins.  This can be done via hda-verb,
too.

If this doesn't help, you might need to try some COEF changes as done
in various quirks in sound/pci/hda/patch_realtek.c.


HTH,

Takashi
