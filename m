Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 4420024A4C9
	for <lists+alsa-devel@lfdr.de>; Wed, 19 Aug 2020 19:20:29 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id C4CA316B2;
	Wed, 19 Aug 2020 19:19:38 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz C4CA316B2
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1597857628;
	bh=YpAqtif9b9psey6iEfLuKmV51aLYuxHOaVaSjTe+0Dg=;
	h=Date:From:To:Subject:In-Reply-To:References:Cc:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=dfLOSBIDeX0HIZz+5eRXgrWeYD3ycerQA++6qS550DV49CPO5jbKXATm2HO891y/8
	 0D9gYRSryzw7BnBy5mfnHVxzW+2mKlyoZ0sEL2AwUITF3NEpohtf78n2cSTC0MhCvT
	 yVamlVQU6O4K5RV0ho0N6DEYYwd5x+XNBE/7Ge1o=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 018BDF800D3;
	Wed, 19 Aug 2020 19:18:47 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id 1D4B5F80218; Wed, 19 Aug 2020 19:18:45 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=RCVD_IN_MSPIKE_H3,
 RCVD_IN_MSPIKE_WL,SPF_HELO_NONE,SPF_PASS,URIBL_BLOCKED autolearn=disabled
 version=3.4.0
Received: from mx2.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id 70CF5F80114
 for <alsa-devel@alsa-project.org>; Wed, 19 Aug 2020 19:18:33 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 70CF5F80114
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.221.27])
 by mx2.suse.de (Postfix) with ESMTP id BE2ABAD8D;
 Wed, 19 Aug 2020 17:18:57 +0000 (UTC)
Date: Wed, 19 Aug 2020 19:18:30 +0200
Message-ID: <s5h364ih7vd.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: penghao <penghao@uniontech.com>
Subject: Re: [PATCH] ALSA: usb-audio: Add prevent wakeup from s3 state trig by
 Lenovo ThinkCentre TI024Gen3 USB-audio
In-Reply-To: <20200819115757.23168-1-penghao@uniontech.com>
References: <20200819115757.23168-1-penghao@uniontech.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
Cc: alsa-devel@alsa-project.org, linux-kernel@vger.kernel.org,
 crwulff@gmail.com, gustavoars@kernel.org, Hui Wang <hui.wang@canonical.com>,
 alexander@tsoy.me, Kai-Heng Feng <kai.heng.feng@canonical.com>,
 Mark Pearson <mpearson@lenovo.com>, dan.carpenter@oracle.com
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

[ Adding a few more relevant people to Cc. ]

On Wed, 19 Aug 2020 13:57:57 +0200,
penghao wrote:
> 
> TI024Gen3 USB-audio is controlled by TI024Gen3,when TI024Gens
> enter sleep mode, USB-audio will disconnect from USB bus port,
> wakup form s3 state
> 
> Signed-off-by: penghao <penghao@uniontech.com>
> ---
>  sound/usb/card.c | 6 ++++++
>  1 file changed, 6 insertions(+)
> 
> diff --git a/sound/usb/card.c b/sound/usb/card.c
> index 696e788c5d31..6bdbb34009b3 100644
> --- a/sound/usb/card.c
> +++ b/sound/usb/card.c
> @@ -658,6 +658,12 @@ static int usb_audio_probe(struct usb_interface *intf,
>  	}
>  
>  	dev_set_drvdata(&dev->dev, chip);
> +	/*
> +	 *ALSA: usb-audio: Add prevent wakeup from s3 state trig by Lenovo
> +	 *ThinkCentre TI024Gen3 usb-audio
> +	 */
> +	if ((usb_id->idVendor == 0x17ef) && (usb_id->idProduct == 0xa012))
> +		device_set_wakeup_enable(ï¼†dev->dev, 0);

Here it's no proper ASCII letter, and this must be broken.
Please check the actual patch before submitting.

In anyway, before going further, I'd like to hear from other people
whether this is really mandatory and appropriate.  And whether it's
specific to that device, too (not other Lenovo devices?)


thanks,

Takashi
