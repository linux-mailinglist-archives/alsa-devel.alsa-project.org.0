Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id A11F12D512
	for <lists+alsa-devel@lfdr.de>; Wed, 29 May 2019 07:31:01 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 294191688;
	Wed, 29 May 2019 07:30:11 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 294191688
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1559107861;
	bh=rliNgA5q8Sh9G60+O7cqAhqkmcQl1Zj6FdfYooXFYKM=;
	h=Date:From:To:In-Reply-To:References:Cc:Subject:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=hlGizgvEBwh4XrxcOdm3nKP0Of5busOfUqx3KY7jiodyqzQLx4I4ZYwtCWnJQ1NNR
	 uPj5iXkr5TB3xCEHkgITv1kUOPyMijhdVoTSwpK1jraDCjhDwv54tRqlRV2CtRlNc5
	 tetyNXDsV1JtUM5zfn2zqF2zNwXoJuNuZma6IfNY=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id B3DEFF896E4;
	Wed, 29 May 2019 07:29:16 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id 4FE9AF896E4; Wed, 29 May 2019 07:29:13 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=SPF_HELO_NONE,SPF_PASS
 autolearn=disabled version=3.4.0
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id BCCE8F8072E
 for <alsa-devel@alsa-project.org>; Wed, 29 May 2019 07:29:09 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz BCCE8F8072E
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id DF937AE04;
 Wed, 29 May 2019 05:29:08 +0000 (UTC)
Date: Wed, 29 May 2019 07:29:08 +0200
Message-ID: <s5hpno16d7f.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
In-Reply-To: <87y32px4vw.wl-kuninori.morimoto.gx@renesas.com>
References: <87y32px4vw.wl-kuninori.morimoto.gx@renesas.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Cc: Linux-ALSA <alsa-devel@alsa-project.org>
Subject: Re: [alsa-devel] Question about card names
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Wed, 29 May 2019 06:41:35 +0200,
Kuninori Morimoto wrote:
> 
> 
> Hi ALSA ML
> 
> snd_soc_instantiate_card() setups card->snd_card's
> "shortname", "longname", "driver" names. (= 1,2,3).
> 
> But, it cares only card->snd_card->driver (= 4).
> I think we need to care about all naming, but why only driver ??

Do you mean the normalization of strings, or do you suggest to make
mandatory?  The normalization isn't needed for other name strings.
The driver name is somewhat special, as it's used as a key for
searches in the user-space.

> 	static int snd_soc_instantiate_card(struct snd_soc_card *card)
> 	{
> 		...
> 1=>		snprintf(card->snd_card->shortname, sizeof(card->snd_card->shortname),
> 			 "%s", card->name);
> 2=>		snprintf(card->snd_card->longname, sizeof(card->snd_card->longname),
> 			 "%s", card->long_name ? card->long_name : card->name);
> 3=>		snprintf(card->snd_card->driver, sizeof(card->snd_card->driver),
> 			 "%s", card->driver_name ? card->driver_name : card->name);
> 		for (i = 0; i < ARRAY_SIZE(card->snd_card->driver); i++) {
> 			switch (card->snd_card->driver[i]) {
> x=>			case '_':
> x=>			case '-':
> 			case '\0':
> 				break;
> 			default:
> 				if (!isalnum(card->snd_card->driver[i]))
> 4=>					card->snd_card->driver[i] = '_';
> 				break;
> 			}
> 		}
> 		...
> 	}
> 
> And, it seems in this loop, it breaks check if it finds "_" or "-" (= x).
> If my understanding was correct,
> the naming "abcd??efg" will be fixed to "abcd__efg",
> but, it do nothing if name was for example "-abcd??efg".

We do replace the two '?' in the latter case, too.  It's a break
statement in a switch block, i.e. just skip the case.


Takashi
_______________________________________________
Alsa-devel mailing list
Alsa-devel@alsa-project.org
https://mailman.alsa-project.org/mailman/listinfo/alsa-devel
