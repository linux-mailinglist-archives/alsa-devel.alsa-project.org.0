Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 5D9BA4F82D
	for <lists+alsa-devel@lfdr.de>; Sat, 22 Jun 2019 22:41:04 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id D2F2C85D;
	Sat, 22 Jun 2019 22:40:13 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz D2F2C85D
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1561236064;
	bh=QN+IYT+6cE8PLHag3OZEgvzIgfHCeLkemzF2ZN1C99c=;
	h=Date:From:To:In-Reply-To:References:Cc:Subject:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=gXc9qagDtYxofhYvpyKbd5pZe1v5KS07BsQjs6PxnxkepW97w0fq1KkCdGRM8WYgW
	 k2M/AtA1exb9S2VLlHrZ7ZfrrA2rnW9Zftd05fyZrSDexBKyC29SvQV5GXfE3GG2H/
	 86dQCxnD+qcCXwhkihX1lkmEsjj2f+AwsnA1dOUY=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 0632BF89717;
	Sat, 22 Jun 2019 22:39:19 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id BB199F89717; Sat, 22 Jun 2019 22:39:15 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: *
X-Spam-Status: No, score=1.0 required=5.0 tests=PRX_BODY_30,SPF_HELO_NONE,
 SPF_PASS autolearn=disabled version=3.4.0
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id AF536F8071F
 for <alsa-devel@alsa-project.org>; Sat, 22 Jun 2019 22:39:12 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz AF536F8071F
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 82A99AD1E;
 Sat, 22 Jun 2019 20:39:11 +0000 (UTC)
Date: Sat, 22 Jun 2019 22:39:11 +0200
Message-ID: <s5h4l4hwe1c.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: "Cezary Rojewski" <cezary.rojewski@intel.com>
In-Reply-To: <f85fe797-f843-bf71-549a-00a169d527dd@intel.com>
References: <20190614094756.2965-1-gregkh@linuxfoundation.org>
 <20190614094756.2965-2-gregkh@linuxfoundation.org>
 <f85fe797-f843-bf71-549a-00a169d527dd@intel.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Cc: alsa-devel@alsa-project.org,
 Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
 Jie Yang <yang.jie@linux.intel.com>,
 Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>,
 Liam Girdwood <liam.r.girdwood@linux.intel.com>,
 Mark Brown <broonie@kernel.org>
Subject: Re: [alsa-devel] [PATCH 2/5] sound: soc: skylake: no need to check
	return value of debugfs_create functions
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Sat, 22 Jun 2019 21:57:07 +0200,
Cezary Rojewski wrote:
> 
> 
> On 2019-06-14 11:47, Greg Kroah-Hartman wrote:
> > When calling debugfs functions, there is no need to ever check the
> > return value.  The function can work or not, but the code logic should
> > never do something different based on this.
> >
> 
> This change heavily impacts user space and development kits used by us
> internally, and our clients. That is, if anything goes wrong during
> debugfs initialization process.
> 
> Currently, apps may safely assume entire debugfs tree is up and
> running once audio stack gets enumerated successfully. With your patch
> this is no longer the case and user space is forced to verify status
> of all debugfs files and/ or directories manually.
> 
> Most of this you knew already - I see Mark was very vocal about
> consequences and possible regression. Nonetheless we have had a short
> meeting with our coe-audio members regarding this change,
> specifically. Conclusion was simple: losing ability to test debugfs
> objects status during their creation e.g.: via IS_ERR family is
> considered harmful.

Well, I just wonder whether you have ever seen a case where the
debugfs creation failed.  Or more practically, would it fail silently
at all?

If there can be a silent failure, then it's bad to just ignore, yes.
We may need either to make it more obvious or return an error.

Of course, in a tight memory pressure, the creation may fail; but the
whole system won't work properly in anyway (not only that the clear
error would be shown in kernel messages), so relying on the debugfs
itself make little sense in such a situation.


thanks,

Takashi
_______________________________________________
Alsa-devel mailing list
Alsa-devel@alsa-project.org
https://mailman.alsa-project.org/mailman/listinfo/alsa-devel
