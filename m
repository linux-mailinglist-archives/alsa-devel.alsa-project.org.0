Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 2F27435F363
	for <lists+alsa-devel@lfdr.de>; Wed, 14 Apr 2021 14:20:32 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 974341679;
	Wed, 14 Apr 2021 14:19:41 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 974341679
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1618402831;
	bh=iD7T+lJqdA8D4a7VvwB8v8UtIGTa45UDfrj3nPSKGck=;
	h=Date:From:To:Subject:In-Reply-To:References:Cc:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=OKXvpMXAslBo37BabqakHDEyG++i8V5lZd0qzSgw21EKrA1gHf6vM+6v6soxOlsvE
	 Tr6w4Qpvd7NEa/3Xg5UjSi4YYfzj7kCh0VxqkD07ELns7G79oFpyhUe6Aa+SgwM87j
	 5FxDCquqnJL2pCfV1zOXox1TrX6SS20mUayklT4s=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id 0FB26F80271;
	Wed, 14 Apr 2021 14:19:03 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id DB996F80269; Wed, 14 Apr 2021 14:18:59 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=SPF_HELO_NONE,SPF_NONE
 autolearn=disabled version=3.4.0
Received: from mx2.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id 805D1F80128
 for <alsa-devel@alsa-project.org>; Wed, 14 Apr 2021 14:18:51 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 805D1F80128
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.221.27])
 by mx2.suse.de (Postfix) with ESMTP id F00F0AFC8;
 Wed, 14 Apr 2021 12:18:50 +0000 (UTC)
Date: Wed, 14 Apr 2021 14:18:50 +0200
Message-ID: <s5hr1jdukid.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: "Hans Hu(SH-RD)" <HansHu@zhaoxin.com>
Subject: Re: [1/2]ALSA: hda: add Zhaoxin HDAC non-snoop support
In-Reply-To: <1ff2d660f086496ea9f56f5f8b90682f@zhaoxin.com>
References: <1ff2d660f086496ea9f56f5f8b90682f@zhaoxin.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
Cc: "'alsa-devel@alsa-project.org'" <alsa-devel@alsa-project.org>,
 "Zhuangzhuang He\(SH-RD\)" <ZhuangzhuangHe@zhaoxin.com>,
 "Leo Liu\(XA-RD\)" <LeoLiu@zhaoxin.com>,
 "Cobe Chen\(BJ-RD\)" <CobeChen@zhaoxin.com>,
 "Tim Guo\(BJ-RD\)" <TimGuo@zhaoxin.com>,
 "Tony W. Wang\(XA-RD\)" <TonyWWang@zhaoxin.com>
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Wed, 14 Apr 2021 14:00:19 +0200,
Hans Hu(SH-RD) wrote:
> 
> Hi Takashi,
> 
> Recently, our(AZX_DRIVER_ZHAOXIN) HDAC controller has added the feature of non-snoop mode, we have written a draft patch for it and hope to be accepted.

The code change looks good.  Please go ahead with the proper
submission.


thanks,

Takashi

> 
> diff --git a/sound/pci/hda/hda_intel.c b/sound/pci/hda/hda_intel.c index b59b0f3..420b728 100644
> --- a/sound/pci/hda/hda_intel.c
> +++ b/sound/pci/hda/hda_intel.c
> @@ -1702,6 +1702,14 @@ static void azx_check_snoop_available(struct azx *chip)
>  snoop = false;
>  }
> 
> +if (azx_get_snoop_type(chip) == AZX_SNOOP_TYPE_NONE &&
> +    chip->driver_type == AZX_DRIVER_ZHAOXIN) {
> +u8 val;
> +pci_read_config_byte(chip->pci, 0x42, &val);
> +if (!(val & 0x80))
> +snoop = false;
> +}
> +
>  if (chip->driver_caps & AZX_DCAPS_SNOOP_OFF)
>  snoop = false;
> 
> 
> Thanks,
> 　Hans Hu :)
> 
> 
> 保密声明：
> 本邮件含有保密或专有信息，仅供指定收件人使用。严禁对本邮件或其内容做任何未经授权的查阅、使用、复制或转发。
> CONFIDENTIAL NOTE:
> This email contains confidential or legally privileged information and is for the sole use of its intended recipient. Any unauthorized review, use, copying or forwarding of this email or the content of this email is strictly prohibited.
