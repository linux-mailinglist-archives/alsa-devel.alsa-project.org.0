Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id B601BA6352
	for <lists+alsa-devel@lfdr.de>; Tue,  3 Sep 2019 10:02:19 +0200 (CEST)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 2E0441679;
	Tue,  3 Sep 2019 10:01:29 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 2E0441679
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1567497739;
	bh=fKuKdZAAfN+FPAThnGEhoWtl3nIae55RAnLTLcU6RJc=;
	h=Date:From:To:Subject:List-Id:List-Unsubscribe:List-Archive:
	 List-Post:List-Help:List-Subscribe:From;
	b=aHcaJcgt4mJ7wtkxVPlB5PDlTSJ+0OarR8NUHdM8HuyjDkcHcxhtfmVdj2Mb9X85w
	 JxEiitnA3D590vBiwfuDZLOu9TeR5duUjNZI9nRiGIvkTv42ZqFt6x/BDjwvD5Y4mh
	 2pF4B5FjwFLCrQUymvpG+IcPMy1gHN9998tuNCWc=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id C2F72F804A9;
	Tue,  3 Sep 2019 10:00:34 +0200 (CEST)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id E7941F8045F; Tue,  3 Sep 2019 10:00:31 +0200 (CEST)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: **
X-Spam-Status: No, score=3.0 required=5.0 tests=AC_FROM_MANY_DOTS,
 SPF_HELO_NONE,SPF_PASS autolearn=disabled version=3.4.0
Received: from relmlie6.idc.renesas.com (relmlor2.renesas.com
 [210.160.252.172])
 by alsa1.perex.cz (Postfix) with ESMTP id 19504F8011E
 for <alsa-devel@alsa-project.org>; Tue,  3 Sep 2019 10:00:26 +0200 (CEST)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 19504F8011E
Date: 03 Sep 2019 17:00:22 +0900
X-IronPort-AV: E=Sophos;i="5.64,462,1559487600"; d="scan'208";a="25395712"
Received: from unknown (HELO relmlir5.idc.renesas.com) ([10.200.68.151])
 by relmlie6.idc.renesas.com with ESMTP; 03 Sep 2019 17:00:22 +0900
Received: from morimoto-PC.renesas.com (unknown [10.166.18.140])
 by relmlir5.idc.renesas.com (Postfix) with ESMTP id 67AC84007523
 for <alsa-devel@alsa-project.org>; Tue,  3 Sep 2019 17:00:22 +0900 (JST)
Message-ID: <87v9u9u7vt.wl-kuninori.morimoto.gx@renesas.com>
From: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
To: Linux-ALSA <alsa-devel@alsa-project.org>
User-Agent: Wanderlust/2.15.9 Emacs/24.5 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Subject: [alsa-devel] some lock needed for flush_delayed_work ?
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>


Hi ALSA ML

I got below error when I unbind/bind CPU DAI.
It seems we need to have some kind of lock ?
I think => message came from

	linux/kernel/locking/lockdep.c :: assign_lock_key

	...
	[    6.392640] asoc-audio-graph-card sound: ASoC: CPU DAI  not registered
=>	[    6.399430] INFO: trying to register non-static key.
=>	[    6.404393] the code is fine but needs lockdep annotation.
=>	[    6.409875] turning off the locking correctness validator.
	[    6.415362] CPU: 2 PID: 193 Comm: test-bind-unbin Not tainted 5.3.0-rc1+ #625
	[    6.422495] Hardware name: Renesas H3ULCB Kingfisher board based on r8a7795 ES2.0+ (DT)
	[    6.430497] Call trace:
	[    6.432949]  dump_backtrace+0x0/0x140
	[    6.436609]  show_stack+0x24/0x30
	[    6.439927]  dump_stack+0xc4/0x10c
	[    6.443328]  register_lock_class+0x4e0/0x618
	[    6.447594]  __lock_acquire+0x7c/0x1de8
	[    6.451426]  lock_acquire+0xdc/0x1e0
	[    6.455000]  del_timer_sync+0x60/0xe8
	[    6.458660]  flush_delayed_work+0x2c/0x70
	[    6.462671]  soc_cleanup_card_resources+0x50/0x348
	[    6.467459]  snd_soc_bind_card+0x1e4/0x990
	[    6.471551]  snd_soc_add_component+0x248/0x310
	[    6.475992]  snd_soc_register_component+0x54/0x70
	[    6.480696]  devm_snd_soc_register_component+0x60/0xb8
	[    6.485833]  rsnd_probe+0x164/0x448
	[    6.489321]  platform_drv_probe+0x58/0xa8
	[    6.493330]  really_probe+0xec/0x2a0
	[    6.496902]  driver_probe_device+0x5c/0xf0
	[    6.500996]  device_driver_attach+0x74/0x80
	[    6.505177]  bind_store+0xdc/0x120
	[    6.508575]  drv_attr_store+0x40/0x58
	[    6.512237]  sysfs_kf_write+0x50/0x78
	[    6.515896]  kernfs_fop_write+0xf0/0x1e8
	[    6.519819]  __vfs_write+0x48/0x90
	[    6.523218]  vfs_write+0xac/0x1b8
	[    6.526529]  ksys_write+0x74/0xf8
	[    6.529840]  __arm64_sys_write+0x24/0x30
	[    6.533762]  el0_svc_common.constprop.0+0x98/0x170
	[    6.538550]  el0_svc_compat_handler+0x2c/0x38
	[    6.542904]  el0_svc_compat+0x8/0x10


Thank you for your help !!
Best regards
---
Kuninori Morimoto
_______________________________________________
Alsa-devel mailing list
Alsa-devel@alsa-project.org
https://mailman.alsa-project.org/mailman/listinfo/alsa-devel
