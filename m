Return-Path: <alsa-devel-bounces@alsa-project.org>
X-Original-To: lists+alsa-devel@lfdr.de
Delivered-To: lists+alsa-devel@lfdr.de
Received: from alsa0.perex.cz (alsa0.perex.cz [77.48.224.243])
	by mail.lfdr.de (Postfix) with ESMTPS id 128FD3431A6
	for <lists+alsa-devel@lfdr.de>; Sun, 21 Mar 2021 09:17:54 +0100 (CET)
Received: from alsa1.perex.cz (alsa1.perex.cz [207.180.221.201])
	(using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by alsa0.perex.cz (Postfix) with ESMTPS id 8439D829;
	Sun, 21 Mar 2021 09:17:03 +0100 (CET)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa0.perex.cz 8439D829
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=alsa-project.org;
	s=default; t=1616314673;
	bh=7L3MnYUNgJovclckMN76vaQ7ZBrITPu97t38oQKtPR4=;
	h=Date:From:To:Subject:In-Reply-To:References:Cc:List-Id:
	 List-Unsubscribe:List-Archive:List-Post:List-Help:List-Subscribe:
	 From;
	b=C7o8Mqcm5pfRRfbKvgBuejdSbBgvczsldZqQEhHHpo5shLJpVI6PLfsYCzkwUq88A
	 q0PxE84NaaCEE5u/G9ED1RNGQPYmnmheFecqZhoXrPYFIHmh3bj88mq+MV8qYYTHMV
	 GtvM/ebU2Mkxt1kh9ms5vZJ4BvaDT1amrDqrOsb0=
Received: from alsa1.perex.cz (localhost.localdomain [127.0.0.1])
	by alsa1.perex.cz (Postfix) with ESMTP id D91FAF80257;
	Sun, 21 Mar 2021 09:16:29 +0100 (CET)
X-Original-To: alsa-devel@alsa-project.org
Delivered-To: alsa-devel@alsa-project.org
Received: by alsa1.perex.cz (Postfix, from userid 50401)
 id E6FCAF80254; Sun, 21 Mar 2021 09:16:27 +0100 (CET)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on alsa1.perex.cz
X-Spam-Level: 
X-Spam-Status: No, score=0.0 required=5.0 tests=SPF_HELO_NONE,SPF_NONE
 autolearn=disabled version=3.4.0
Received: from mx2.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by alsa1.perex.cz (Postfix) with ESMTPS id 981F4F80155
 for <alsa-devel@alsa-project.org>; Sun, 21 Mar 2021 09:16:20 +0100 (CET)
DKIM-Filter: OpenDKIM Filter v2.11.0 alsa1.perex.cz 981F4F80155
X-Virus-Scanned: by amavisd-new at test-mx.suse.de
Received: from relay2.suse.de (unknown [195.135.221.27])
 by mx2.suse.de (Postfix) with ESMTP id D9177AD38;
 Sun, 21 Mar 2021 08:16:14 +0000 (UTC)
Date: Sun, 21 Mar 2021 09:16:14 +0100
Message-ID: <s5htup4exbl.wl-tiwai@suse.de>
From: Takashi Iwai <tiwai@suse.de>
To: Tong Zhang <ztong0001@gmail.com>
Subject: Re: [PATCH v2 0/3] ALSA: hdsp and hdspm,
 don't disable device if not enabled
In-Reply-To: <20210320222337.243368-1-ztong0001@gmail.com>
References: <20210320222337.243368-1-ztong0001@gmail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI/1.14.6 (Maruoka)
 FLIM/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL/10.8 Emacs/25.3
 (x86_64-suse-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Cc: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>,
 alsa-devel@alsa-project.org, "Gustavo A. R. Silva" <gustavoars@kernel.org>,
 Leon Romanovsky <leon@kernel.org>, Tom Rix <trix@redhat.com>,
 Allen Pais <allen.lkml@gmail.com>, Takashi Iwai <tiwai@suse.com>,
 Joe Perches <joe@perches.com>, Mark Brown <broonie@kernel.org>,
 Romain Perier <romain.perier@gmail.com>, linux-kernel@vger.kernel.org,
 Jasmin Fazlic <superfassl@gmail.com>
X-BeenThere: alsa-devel@alsa-project.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: "Alsa-devel mailing list for ALSA developers -
 http://www.alsa-project.org" <alsa-devel.alsa-project.org>
List-Unsubscribe: <https://mailman.alsa-project.org/mailman/options/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=unsubscribe>
List-Archive: <http://mailman.alsa-project.org/pipermail/alsa-devel/>
List-Post: <mailto:alsa-devel@alsa-project.org>
List-Help: <mailto:alsa-devel-request@alsa-project.org?subject=help>
List-Subscribe: <https://mailman.alsa-project.org/mailman/listinfo/alsa-devel>, 
 <mailto:alsa-devel-request@alsa-project.org?subject=subscribe>
Errors-To: alsa-devel-bounces@alsa-project.org
Sender: "Alsa-devel" <alsa-devel-bounces@alsa-project.org>

On Sat, 20 Mar 2021 23:23:33 +0100,
Tong Zhang wrote:
> 
> This series fixes issues in hdsp and hdspm. The drivers in question want
> to disable a device that is not enabled on error path.
> 
> v2: add fix to rme9652
> 
> Tong Zhang (3):
>   ALSA: hdsp: don't disable if not enabled
>   ALSA: hdspm: don't disable if not enabled
>   ALSA: rme9652: don't disable if not enabled

Thanks for the patches.

IMO, a safer way for this is to add pci_is_enabled() check in *_free()
functions around the call of pci_disable_device().  The point is that
*_free() is the sole destructor function that manages all stuff, hence
it's better to do all there.  And, of course, it'll be less changes.

Care to resend v3 patches with that?


thanks,

Takashi
